<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°å‰é£</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://annilq.github.io/"/>
  <updated>2019-08-02T01:52:16.573Z</updated>
  <id>https://annilq.github.io/</id>
  
  <author>
    <name>annilq</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>A Basic 38 Line Reimplementation of Redux</title>
    <link href="https://annilq.github.io/2019/03/14/redux/"/>
    <id>https://annilq.github.io/2019/03/14/redux/</id>
    <published>2019-03-14T05:53:10.000Z</published>
    <updated>2019-08-02T01:52:16.573Z</updated>
    
    <content type="html"><![CDATA[<p>åŸæ–‡:<a href="https://repl.it/@dericgw/ReduxRecreated" target="_blank" rel="noopener">A Basic 38 Line Reimplementation of Redux</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer, initialState</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> currentState = initialState;</span><br><span class="line">  <span class="keyword">const</span> listeners = [];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getState</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> currentState;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">subscribe</span>(<span class="params">listener</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> listener !== <span class="string">'function'</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'A listener must be a function'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    listeners.push(listener);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">unsubscribe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> index = listeners.indexOf(listener);</span><br><span class="line">      listeners.splice(index, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params">action</span>) </span>&#123;</span><br><span class="line">    currentState = reducer(currentState, action);</span><br><span class="line">    </span><br><span class="line">    listeners.forEach(<span class="function"><span class="params">listener</span> =&gt;</span> listener());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> action;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  dispatch(&#123; <span class="attr">type</span>: <span class="string">'INIT'</span>&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    getState,</span><br><span class="line">    subscribe,</span><br><span class="line">    dispatch,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// End the Redux implementation</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Reducer</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reducer</span>(<span class="params">state = &#123; firstName: <span class="string">'John'</span>, lastName: <span class="string">'Smith'</span> &#125;, action</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'UPDATE_FIRSTNAME'</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">          ...state,</span><br><span class="line">          firstName: action.payload,</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'UPDATE_LASTNAME'</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        lastName: action.payload,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Action creators</span></span><br><span class="line"><span class="keyword">const</span> updateFirstName = <span class="function"><span class="params">firstName</span> =&gt;</span> (&#123;</span><br><span class="line">  type: <span class="string">'UPDATE_FIRSTNAME'</span>,</span><br><span class="line">  payload: firstName,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> updateLastName = <span class="function"><span class="params">lastName</span> =&gt;</span> (&#123;</span><br><span class="line">  type: <span class="string">'UPDATE_LASTNAME'</span>,</span><br><span class="line">  payload: lastName,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create the store</span></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get initial state</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`INITIAL STATE: <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(store.getState())&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Subscribe to state changes</span></span><br><span class="line"><span class="keyword">const</span> unsub = store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Subscription fired`</span>, <span class="built_in">JSON</span>.stringify(store.getState()));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dispatch an action</span></span><br><span class="line">store.dispatch(updateFirstName(<span class="string">'Tommy'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Unsubscribe our listener</span></span><br><span class="line">unsub();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dispatch another action</span></span><br><span class="line">store.dispatch(updateLastName(<span class="string">'Watson'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the current state</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(store.getState()));</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŸæ–‡:&lt;a href=&quot;https://repl.it/@dericgw/ReduxRecreated&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;A Basic 38 Line Reimplementation of Redux&lt;/a&gt;&lt;/p&gt;
&lt;fi
      
    
    </summary>
    
    
      <category term="Redux" scheme="https://annilq.github.io/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>2019</title>
    <link href="https://annilq.github.io/2019/02/20/2019/"/>
    <id>https://annilq.github.io/2019/02/20/2019/</id>
    <published>2019-02-20T03:22:01.000Z</published>
    <updated>2019-08-02T01:52:16.572Z</updated>
    
    <content type="html"><![CDATA[<p>2019å¹´ä¹Ÿå¼€å§‹å¾ˆä¹…å•¦ï¼Œæœ€è¿‘ç”Ÿæ´»å’Œå·¥ä½œçš„çŠ¶æ€è¿˜æ˜¯æ²¡æœ‰è°ƒæ•´è¿‡æ¥ï¼Œæ•´ä¸ªäººæœ‰ç‚¹çƒ¦èºï¼Œå¸Œæœ›å€Ÿæ­¤æœºä¼šå¯ä»¥é€‚å½“å‘æ³„ä¸€ä¸‹ï¼Œè€Œä¸”ä¹ŸæœŸè®¸ä¸€ä¸‹2019çš„ç”Ÿæ´»</p><p>æ•´ä¸ª18å¹´ç°åœ¨å›æƒ³èµ·æ¥è¿‡çš„æ¯”è¾ƒå¿™ä¹±åˆå•è°ƒï¼Œç°åœ¨å›æƒ³èµ·æ¥ä¹Ÿä¸è¿‡æ˜¯æŠŠæ–°æˆ¿è£…ä¿®äº†ä¸‹ï¼Œç«Ÿç„¶å¦‚æ­¤ä¼¤ç¥ï¼Œå¥½åœ¨å¨ƒå¨ƒè¿˜ç®—å¥åº·ï¼Œæ“å¿ƒçš„äº‹æƒ…ä¸æ˜¯å¾ˆå¤šï¼Œè¿™ä¸€å¹´æ²¡æœ‰æ€ä¹ˆçœ‹ç”µå½±ï¼Œæ²¡æœ‰æ€ä¹ˆè¯»ä¹¦å­¦ä¹ ï¼Œä¹Ÿæ²¡æœ‰æ€ä¹ˆè¿åŠ¨ï¼Œæ‰€ä»¥æ„Ÿè§‰è¿™ä¸€å¹´çš„ç”Ÿæ´»çŠ¶æ€å’Œä»¥å‰æœ‰å¾ˆå¤§ä¸åŒï¼Œæœ‰ç‚¹ç•¥å¾®ä¸é€‚åº”ï¼Œè¦æŠŠç²¾åŠ›åˆ†äº«ç»™å®¶é‡Œå¤šä¸€äº›ï¼Œä¸è¿‡å¬åˆ°ä»”ä»”å«çˆ¸çˆ¸è¿˜æ˜¯è›®å¼€å¿ƒçš„ã€‚</p><p>ä»Šå¹´ä»”ä»”çš„å¦¹å¦¹ï¼ˆå¸Œæœ›æ˜¯ï¼‰äºŒä¸«é©¬ä¸Šå°±æ¥äº†ï¼Œå‹åŠ›è¿˜æ˜¯è›®å¤§ï¼Œè‡ªå·±ä¹Ÿæ²¡æœ‰æ‰¾åˆ°èˆ’é€‚åŒºï¼Œæ²¡æƒ³åˆ°æ›¾ç»ä¸­äºŒçš„äººä¹Ÿå¿«æˆäº†ä¸¤ä¸ªå­©å­çš„çˆ¸çˆ¸ï¼Œå¸Œæœ›è‡ªå·±å¯ä»¥æ…¢æ…¢é€‚åº”è¿™ä¸ªè§’è‰²ï¼Œå´è€å¸ˆè¿™ä¸¤å¹´å¸¦å°å­©å„¿ä¹Ÿæ¯”è¾ƒè¾›è‹¦ï¼Œå¸Œæœ›ä»¥åå¯ä»¥å¤šå¤šæ²Ÿé€šï¼Œå°‘ç‚¹æ‹Œå˜´ï¼Œå¤šäº›ç†è§£ï¼Œæˆ‘è‡ªå·±ä¹ŸåŠªåŠ›æ‰¾å›çŠ¶æ€ï¼Œåœ¨å·¥ä½œã€ç”Ÿæ´»å­¦ä¹ èƒ½å¤Ÿæ›´è¿›ä¸€æ­¥ï¼Œé¡ºä¾¿æ‰¾æ—¶é—´æŠŠé©¾ç…§ä¹Ÿè€ƒäº†ï¼Œä¸ç„¶å‡ºé—¨å¤ªéº»çƒ¦äº†ï¼Œä¸‰åè€Œç«‹ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¤Ÿæˆé•¿ä¸€äº›ã€‚</p><p>æ€»ç»“ä¹Ÿæ˜¯ç¢ç¢çš„~~~</p><p>æœ€åå¸Œæœ›å®¶äººå’Œæœ‹å‹éƒ½èƒ½å¤Ÿèº«ä½“å¥åº·ï¼Œè¯¸äº‹é¡ºå¿ƒï¼Œå°±è¿™æ ·ï¼ŒåŠ æ²¹ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;2019å¹´ä¹Ÿå¼€å§‹å¾ˆä¹…å•¦ï¼Œæœ€è¿‘ç”Ÿæ´»å’Œå·¥ä½œçš„çŠ¶æ€è¿˜æ˜¯æ²¡æœ‰è°ƒæ•´è¿‡æ¥ï¼Œæ•´ä¸ªäººæœ‰ç‚¹çƒ¦èºï¼Œå¸Œæœ›å€Ÿæ­¤æœºä¼šå¯ä»¥é€‚å½“å‘æ³„ä¸€ä¸‹ï¼Œè€Œä¸”ä¹ŸæœŸè®¸ä¸€ä¸‹2019çš„ç”Ÿæ´»&lt;/p&gt;
&lt;p&gt;æ•´ä¸ª18å¹´ç°åœ¨å›æƒ³èµ·æ¥è¿‡çš„æ¯”è¾ƒå¿™ä¹±åˆå•è°ƒï¼Œç°åœ¨å›æƒ³èµ·æ¥ä¹Ÿä¸è¿‡æ˜¯æŠŠæ–°æˆ¿è£…ä¿®äº†ä¸‹ï¼Œç«Ÿç„¶å¦‚æ­¤ä¼¤ç¥ï¼Œå¥½åœ¨å¨ƒå¨ƒè¿˜ç®—å¥åº·ï¼Œæ“å¿ƒçš„äº‹æƒ…ä¸
      
    
    </summary>
    
    
      <category term="2019" scheme="https://annilq.github.io/tags/2019/"/>
    
  </entry>
  
  <entry>
    <title>ReactéªŒè¯ç™»å½•æƒé™</title>
    <link href="https://annilq.github.io/2018/05/21/react-auth/"/>
    <id>https://annilq.github.io/2018/05/21/react-auth/</id>
    <published>2018-05-21T02:50:15.000Z</published>
    <updated>2018-05-21T13:01:33.717Z</updated>
    
    <content type="html"><![CDATA[<h3 id="react-native-appä¸react-app-æƒé™éªŒè¯"><a href="#react-native-appä¸react-app-æƒé™éªŒè¯" class="headerlink" title="react native appä¸react app æƒé™éªŒè¯"></a>react native appä¸react app æƒé™éªŒè¯</h3><ol><li>react native appå®Œå…¨ç”±ç¨‹åºæ§åˆ¶è·³è½¬ï¼Œreact appå¯ä»¥æ‰‹åŠ¨è·³è½¬</li><li>react native appè·³è½¬ä¾èµ– <code>React Navigation</code>,react appè·³è½¬ä¾èµ– <code>React Router</code></li><li>è·³è½¬æ–¹å¼<ol><li>Redux integration</li><li>Redirect<h4 id="Redux-integration"><a href="#Redux-integration" class="headerlink" title="Redux integration"></a>Redux integration</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  View,</span><br><span class="line">  Text,</span><br><span class="line">  ActivityIndicator,</span><br><span class="line">  StyleSheet,</span><br><span class="line">  AsyncStorage</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"react-native"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthLoadingScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>._bootstrapAsync();</span><br><span class="line">  &#125;</span><br><span class="line">  _bootstrapAsync = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> userToken = <span class="keyword">await</span> AsyncStorage.getItem(<span class="string">"userToken"</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"userToken"</span>, userToken);</span><br><span class="line">    <span class="keyword">this</span>.props.navigation.dispatch(&#123; <span class="attr">type</span>: userToken ? <span class="string">"Login"</span> : <span class="string">"Logout"</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;ActivityIndicator /&gt;</span><br><span class="line">      &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">  container: &#123;</span></span><br><span class="line"><span class="regexp">    flex: 1,</span></span><br><span class="line"><span class="regexp">    alignItems: "center",</span></span><br><span class="line"><span class="regexp">    justifyContent: "center"</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">export default AuthLoadingScreen;</span></span><br></pre></td></tr></table></figure></li></ol></li></ol><h4 id="Redirecté‡å®šå‘"><a href="#Redirecté‡å®šå‘" class="headerlink" title="Redirecté‡å®šå‘"></a>Redirecté‡å®šå‘</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">"react-redux"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Redirect, Route &#125; <span class="keyword">from</span> <span class="string">"react-router"</span>;</span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">&#123; isLogin &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    isLogin</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">@connect(mapStateToProps)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Auth</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; isLogin &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">return</span> isLogin ? (</span><br><span class="line">      &lt;Route exact path=<span class="string">"/"</span> render=&#123;() =&gt; <span class="xml"><span class="tag">&lt;<span class="name">Redirect</span> <span class="attr">to</span>=<span class="string">"/dashboard"</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">    ) : (</span></span><br><span class="line">      &lt;Redirect to="/login" /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Auth;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><ol><li><a href="https://medium.com/@kelleyannerose/react-native-activityindicator-for-a-quick-easy-loading-animation-593c06c044dc" target="_blank" rel="noopener">React Native ActivityIndicator for a Quick &amp; Easy Loading Animation</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;react-native-appä¸react-app-æƒé™éªŒè¯&quot;&gt;&lt;a href=&quot;#react-native-appä¸react-app-æƒé™éªŒè¯&quot; class=&quot;headerlink&quot; title=&quot;react native appä¸react app æƒé™éªŒ
      
    
    </summary>
    
    
      <category term="react" scheme="https://annilq.github.io/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>build your own react</title>
    <link href="https://annilq.github.io/2018/05/04/react/"/>
    <id>https://annilq.github.io/2018/05/04/react/</id>
    <published>2018-05-04T07:48:15.000Z</published>
    <updated>2018-05-21T13:06:18.457Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å…ˆä¸Šreact-jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç "><a href="#å…ˆä¸Šreact-jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç " class="headerlink" title="å…ˆä¸Šreact.jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç "></a>å…ˆä¸Šreact.jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createDOMFromString = <span class="function">(<span class="params">domString</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line">  div.innerHTML = domString</span><br><span class="line">  <span class="keyword">return</span> div</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    setState (state) &#123;</span><br><span class="line">      <span class="keyword">const</span> oldEl = <span class="keyword">this</span>.el</span><br><span class="line">      <span class="keyword">this</span>.state = state</span><br><span class="line">      <span class="keyword">this</span>._renderDOM()</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.onStateChange) <span class="keyword">this</span>.onStateChange(oldEl, <span class="keyword">this</span>.el)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _renderDOM () &#123;</span><br><span class="line">      <span class="keyword">this</span>.el = createDOMFromString(<span class="keyword">this</span>.render())</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.el</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">LikeButton</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">      <span class="keyword">super</span>(props)</span><br><span class="line">      <span class="keyword">this</span>.state = &#123; <span class="attr">isLiked</span>: <span class="literal">false</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    onClick () &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">        isLiked: !<span class="keyword">this</span>.state.isLiked</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;button class='like-btn' style="background-color: <span class="subst">$&#123;<span class="keyword">this</span>.props.bgColor&#125;</span>"&gt;</span></span><br><span class="line"><span class="string">          &lt;span class='like-text'&gt;</span></span><br><span class="line"><span class="string">            <span class="subst">$&#123;<span class="keyword">this</span>.state.isLiked ? <span class="string">'å–æ¶ˆ'</span> : <span class="string">'ç‚¹èµ'</span>&#125;</span></span></span><br><span class="line"><span class="string">          &lt;/span&gt;</span></span><br><span class="line"><span class="string">          &lt;span&gt;ğŸ‘&lt;/span&gt;</span></span><br><span class="line"><span class="string">        &lt;/button&gt;</span></span><br><span class="line"><span class="string">      `</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">const</span> mount = <span class="function">(<span class="params">component, wrapper</span>) =&gt;</span> &#123;</span><br><span class="line">    wrapper.appendChild(component._renderDOM())</span><br><span class="line">    component.onStateChange = <span class="function">(<span class="params">oldEl, newEl</span>) =&gt;</span> &#123;</span><br><span class="line">      wrapper.insertBefore(newEl, oldEl)</span><br><span class="line">      wrapper.removeChild(oldEl)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">mount(<span class="keyword">new</span> LikeButton(&#123; <span class="attr">bgColor</span>: <span class="string">'red'</span> &#125;), wrapper)</span><br></pre></td></tr></table></figure><h4 id="ä»£ç è¯´æ˜"><a href="#ä»£ç è¯´æ˜" class="headerlink" title="ä»£ç è¯´æ˜"></a>ä»£ç è¯´æ˜</h4><ol><li><code>createDOMFromString</code>æ–¹æ³•ç”¨äºå°†domå­—ç¬¦ä¸²è½¬æˆdom</li><li><code>mount</code>æ–¹æ³•ç”¨äºå°†ç»„ä»¶ä¸é¡µé¢çš„domå…ƒç´ <code>wrapper</code>åˆå§‹åŒ–å…³è”<ol><li><code>onStateChange</code>åº”è¯¥è®¾ç½®å®ä¾‹ç»„ä»¶ä¸Šé¢</li></ol></li><li>é¦–å…ˆå…¬å…±çš„éƒ¨åˆ†æŠ½è±¡æˆä¸€ä¸ªcomponentç»„ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸¤ä¸ªæ–¹æ³•<ol><li><code>setState</code>å­ç»„ä»¶è°ƒç”¨æ—¶ï¼Œæ ¹æ®stateé‡æ–°æ¸²æŸ“ç»„ä»¶</li><li><code>_renderDOM</code> æ ¹æ®stateå˜åŒ–è°ƒç”¨<code>render</code>æ–¹æ³•é‡æ–°æ¸²æŸ“ç»„ä»¶</li><li>å®ä¾‹ç»„ä»¶å¿…é¡»æœ‰å®ä¾‹<code>render</code>æ–¹æ³•ç”¨äºçˆ¶ç»„ä»¶è°ƒç”¨</li></ol></li></ol><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><ol><li><a href="https://medium.com/@sweetpalma/gooact-react-in-160-lines-of-javascript-44e0742ad60f" target="_blank" rel="noopener">React in 160 lines of JavaScript</a></li><li><a href="http://huziketang.mangojuice.top/books/react/" target="_blank" rel="noopener">React.js å°ä¹¦</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;å…ˆä¸Šreact-jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç &quot;&gt;&lt;a href=&quot;#å…ˆä¸Šreact-jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç &quot; class=&quot;headerlink&quot; title=&quot;å…ˆä¸Šreact.jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç &quot;&gt;&lt;/a&gt;å…ˆä¸Šreact.jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç &lt;/
      
    
    </summary>
    
    
      <category term="react" scheme="https://annilq.github.io/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>100è¡Œå®ç°JavaScriptè·¯ç”±å™¨</title>
    <link href="https://annilq.github.io/2018/03/16/router/"/>
    <id>https://annilq.github.io/2018/03/16/router/</id>
    <published>2018-03-16T03:44:01.000Z</published>
    <updated>2018-05-21T13:01:33.720Z</updated>
    
    <content type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥<br><a href="http://krasimirtsonev.com/blog/article/A-modern-JavaScript-router-in-100-lines-history-api-pushState-hash-url" target="_blank" rel="noopener">A modern JavaScript router in 100 lines</a><br><a href="https://tylermcginnis.com/build-your-own-react-router-v4/" target="_blank" rel="noopener">Build your own React Router v4</a></p><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ol><li>é…ç½®è·¯ç”±</li><li>æ·»åŠ è·¯ç”±</li><li>ç›‘å¬è·¯ç”±<ol><li>å®šæ—¶ç›‘å¬</li><li>hashChange</li><li>popstate</li></ol></li></ol><h3 id="ä¸€ä¸ªåŸºæœ¬è·¯ç”±å®ç°çš„ä»£ç "><a href="#ä¸€ä¸ªåŸºæœ¬è·¯ç”±å®ç°çš„ä»£ç " class="headerlink" title="ä¸€ä¸ªåŸºæœ¬è·¯ç”±å®ç°çš„ä»£ç "></a>ä¸€ä¸ªåŸºæœ¬è·¯ç”±å®ç°çš„ä»£ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Router = &#123;</span><br><span class="line">    routes: [],</span><br><span class="line">    mode: <span class="literal">null</span>,</span><br><span class="line">    root: <span class="string">'/'</span>,</span><br><span class="line">    config: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mode = options &amp;&amp; options.mode &amp;&amp; options.mode == <span class="string">'history'</span> </span><br><span class="line">                    &amp;&amp; !!(history.pushState) ? <span class="string">'history'</span> : <span class="string">'hash'</span>;</span><br><span class="line">        <span class="keyword">this</span>.root = options &amp;&amp; options.root ? <span class="string">'/'</span> + <span class="keyword">this</span>.clearSlashes(options.root) + <span class="string">'/'</span> : <span class="string">'/'</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    getFragment: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> fragment = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.mode === <span class="string">'history'</span>) &#123;</span><br><span class="line">            fragment = <span class="keyword">this</span>.clearSlashes(<span class="built_in">decodeURI</span>(location.pathname + location.search));</span><br><span class="line">            fragment = fragment.replace(<span class="regexp">/\?(.*)$/</span>, <span class="string">''</span>);</span><br><span class="line">            fragment = <span class="keyword">this</span>.root != <span class="string">'/'</span> ? fragment.replace(<span class="keyword">this</span>.root, <span class="string">''</span>) : fragment;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> match = <span class="built_in">window</span>.location.href.match(<span class="regexp">/#(.*)$/</span>);</span><br><span class="line">            fragment = match ? match[<span class="number">1</span>] : <span class="string">''</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.clearSlashes(fragment);</span><br><span class="line">    &#125;,</span><br><span class="line">    clearSlashes: <span class="function"><span class="keyword">function</span>(<span class="params">path</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> path.toString().replace(<span class="regexp">/\/$/</span>, <span class="string">''</span>).replace(<span class="regexp">/^\//</span>, <span class="string">''</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    add: <span class="function"><span class="keyword">function</span>(<span class="params">re, handler</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> re == <span class="string">'function'</span>) &#123;</span><br><span class="line">            handler = re;</span><br><span class="line">            re = <span class="string">''</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.routes.push(&#123; <span class="attr">re</span>: re, <span class="attr">handler</span>: handler&#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    remove: <span class="function"><span class="keyword">function</span>(<span class="params">param</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>, r; i&lt;<span class="keyword">this</span>.routes.length, r = <span class="keyword">this</span>.routes[i]; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(r.handler === param || r.re.toString() === param.toString()) &#123;</span><br><span class="line">                <span class="keyword">this</span>.routes.splice(i, <span class="number">1</span>); </span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    flush: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.routes = [];</span><br><span class="line">        <span class="keyword">this</span>.mode = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">this</span>.root = <span class="string">'/'</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    check: <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> fragment = f || <span class="keyword">this</span>.getFragment();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="keyword">this</span>.routes.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> match = fragment.match(<span class="keyword">this</span>.routes[i].re);</span><br><span class="line">            <span class="keyword">if</span>(match) &#123;</span><br><span class="line">                match.shift();</span><br><span class="line">                <span class="keyword">this</span>.routes[i].handler.apply(&#123;&#125;, match);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">            &#125;           </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    listen: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">var</span> current = self.getFragment();</span><br><span class="line">        <span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (current !== self.getFragment()) &#123;</span><br><span class="line">                current = self.getFragment();</span><br><span class="line">                self.check(current);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (history.pushState) &#123;</span><br><span class="line">            <span class="built_in">window</span>.onpopstate = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'state: '</span> + <span class="built_in">JSON</span>.stringify(event.state));</span><br><span class="line">                fn()</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            clearInterval(<span class="keyword">this</span>.interval);</span><br><span class="line">            <span class="keyword">this</span>.interval = setInterval(fn, <span class="number">50</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    navigate: <span class="function"><span class="keyword">function</span>(<span class="params">path</span>) </span>&#123;</span><br><span class="line">        path = path ? path : <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.mode === <span class="string">'history'</span>) &#123;</span><br><span class="line">            history.pushState(<span class="literal">null</span>, <span class="literal">null</span>, <span class="keyword">this</span>.root + <span class="keyword">this</span>.clearSlashes(path));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">window</span>.location.href = <span class="built_in">window</span>.location.href.replace(<span class="regexp">/#(.*)$/</span>, <span class="string">''</span>) + <span class="string">'#'</span> + path;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// configuration</span></span><br><span class="line">Router.config(&#123; <span class="attr">mode</span>: <span class="string">'history'</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// returning the user to the initial state</span></span><br><span class="line">Router.navigate();</span><br><span class="line"></span><br><span class="line"><span class="comment">// adding routes</span></span><br><span class="line">Router</span><br><span class="line">.add(<span class="regexp">/about/</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'about'</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.add(<span class="regexp">/products\/(.*)\/edit\/(.*)/</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'products'</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.add(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'default'</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.check(<span class="string">'/products/12/edit/22'</span>).listen();</span><br><span class="line"></span><br><span class="line"><span class="comment">// forwarding</span></span><br><span class="line">Router.navigate(<span class="string">'/about'</span>);</span><br></pre></td></tr></table></figure><h3 id="react-routerä¸­çš„è·¯ç”±ç”¨æ³•"><a href="#react-routerä¸­çš„è·¯ç”±ç”¨æ³•" class="headerlink" title="react-routerä¸­çš„è·¯ç”±ç”¨æ³•"></a>react-routerä¸­çš„è·¯ç”±ç”¨æ³•</h3><p>react-routerä¸­è·¯ç”±æä¾›ä¸¤ä¸ªåŸºç¡€çš„ç»„ä»¶<link>,<route>,<redirect></redirect></route></p><ol><li><p><route>,é¡¹ç›®åˆå§‹åŒ–çš„æ—¶å€™<route>ç»„ä»¶æ—¶å€™ä¼šæœ‰ä¸¤æ­¥æ“ä½œ</route></route></p><ol><li>ä¼šç»‘å®špopstateäº‹ä»¶ï¼Œå¦‚æœæœ‰äº‹ä»¶å‘ç”Ÿç«‹å³åˆ·æ–°ç»„ä»¶</li><li>å°†ç»„ä»¶å®ä¾‹åŠ å…¥åˆ°è§‚å¯Ÿåˆ—è¡¨instanceså½“ä¸­ï¼Œæ–¹ä¾¿æœ‰history stateå˜åŒ–çš„æ—¶å€™å°†åˆ—è¡¨ä¸­å®ä¾‹é‡æ–°æ¸²æŸ“</li></ol></li><li><p><link>ç»„ä»¶è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œè°ƒç”¨ history.pushState({}, null, path)æ›´æ–°history,å¹¶é‡æ–°æ¸²æŸ“è§‚å¯Ÿåˆ—è¡¨instancesé‡Œé¢çš„routeç»„ä»¶ï¼Œæ˜¾ç¤ºå¯¹åº”çš„ç»„ä»¶</p></li><li><p><redirect>ç»„ä»¶æœ‰ä¸¤ä¸ªå±æ€§to,path,ç”¨æ¥è·³è½¬</redirect></p><blockquote><p>è°ƒç”¨history.pushState()æˆ–è€…history.replaceState()ä¸ä¼šè§¦å‘popstateäº‹ä»¶. popstateäº‹ä»¶åªä¼šåœ¨æµè§ˆå™¨æŸäº›è¡Œä¸ºä¸‹è§¦å‘, æ¯”å¦‚ç‚¹å‡»åé€€ã€å‰è¿›æŒ‰é’®(æˆ–è€…åœ¨JavaScriptä¸­è°ƒç”¨history.back()ã€history.forward()ã€history.go()æ–¹æ³•)</p></blockquote></li><li><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; PropTypes, Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instances = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> register = <span class="function">(<span class="params">comp</span>) =&gt;</span> instances.push(comp)</span><br><span class="line"><span class="keyword">const</span> unregister = <span class="function">(<span class="params">comp</span>) =&gt;</span> instances.splice(instances.indexOf(comp), <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> historyPush = <span class="function">(<span class="params">path</span>) =&gt;</span> &#123;</span><br><span class="line">  history.pushState(&#123;&#125;, <span class="literal">null</span>, path)</span><br><span class="line">  instances.forEach(<span class="function"><span class="params">instance</span> =&gt;</span> instance.forceUpdate())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> historyReplace = <span class="function">(<span class="params">path</span>) =&gt;</span> &#123;</span><br><span class="line">  history.replaceState(&#123;&#125;, <span class="literal">null</span>, path)</span><br><span class="line">  instances.forEach(<span class="function"><span class="params">instance</span> =&gt;</span> instance.forceUpdate())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> matchPath = <span class="function">(<span class="params">pathname, options</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; exact = <span class="literal">false</span>, path &#125; = options</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!path) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      path: <span class="literal">null</span>,</span><br><span class="line">      url: pathname,</span><br><span class="line">      isExact: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> match = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`^<span class="subst">$&#123;path&#125;</span>`</span>).exec(pathname)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!match)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> url = match[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> isExact = pathname === url</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (exact &amp;&amp; !isExact)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    path,</span><br><span class="line">    url,</span><br><span class="line">    isExact,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Route</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> propTypes: &#123;</span><br><span class="line">    path: PropTypes.string,</span><br><span class="line">    exact: PropTypes.bool,</span><br><span class="line">    component: PropTypes.func,</span><br><span class="line">    render: PropTypes.func,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    addEventListener(<span class="string">"popstate"</span>, <span class="keyword">this</span>.handlePop)</span><br><span class="line">    register(<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    unregister(<span class="keyword">this</span>)</span><br><span class="line">    removeEventListener(<span class="string">"popstate"</span>, <span class="keyword">this</span>.handlePop)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handlePop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.forceUpdate()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">      path,</span><br><span class="line">      exact,</span><br><span class="line">      component,</span><br><span class="line">      render,</span><br><span class="line">    &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> match = matchPath(location.pathname, &#123; path, exact &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!match)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (component)</span><br><span class="line">      <span class="keyword">return</span> React.createElement(component, &#123; match &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (render)</span><br><span class="line">      <span class="keyword">return</span> render(&#123; match &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Link</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">    to: PropTypes.string.isRequired,</span><br><span class="line">    replace: PropTypes.bool,</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; replace, to &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">    event.preventDefault()</span><br><span class="line">    replace ? historyReplace(to) : historyPush(to)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; to, children&#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;a href=&#123;to&#125; onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">        &#123;children&#125;</span><br><span class="line">      &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class Redirect extends Component &#123;</span></span><br><span class="line"><span class="regexp">  static defaultProps = &#123;</span></span><br><span class="line"><span class="regexp">    push: false</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  static propTypes = &#123;</span></span><br><span class="line"><span class="regexp">    to: PropTypes.string.isRequired,</span></span><br><span class="line"><span class="regexp">    push: PropTypes.bool.isRequired,</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  componentDidMount() &#123;</span></span><br><span class="line"><span class="regexp">    const &#123; to, push &#125; = this.props</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    push ? historyPush(to) : historyReplace(to)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return null</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŸæ–‡é“¾æ¥&lt;br&gt;&lt;a href=&quot;http://krasimirtsonev.com/blog/article/A-modern-JavaScript-router-in-100-lines-history-api-pushState-hash-url&quot; target=&quot;_
      
    
    </summary>
    
    
      <category term="react router" scheme="https://annilq.github.io/tags/react-router/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨herokuéƒ¨ç½²nodejsé¡¹ç›®</title>
    <link href="https://annilq.github.io/2018/02/23/heroku/"/>
    <id>https://annilq.github.io/2018/02/23/heroku/</id>
    <published>2018-02-23T07:43:01.000Z</published>
    <updated>2018-02-23T11:32:35.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="herokuå‚è€ƒæ–‡æ¡£"><a href="#herokuå‚è€ƒæ–‡æ¡£" class="headerlink" title="herokuå‚è€ƒæ–‡æ¡£"></a>herokuå‚è€ƒæ–‡æ¡£</h3><p><a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#introduction" target="_blank" rel="noopener">getting-started-with-nodejs</a></p><h3 id="heroku-å‘å¸ƒé¡¹ç›®æµç¨‹ä»¥åŠå¸¸ç”¨å‘½ä»¤"><a href="#heroku-å‘å¸ƒé¡¹ç›®æµç¨‹ä»¥åŠå¸¸ç”¨å‘½ä»¤" class="headerlink" title="heroku å‘å¸ƒé¡¹ç›®æµç¨‹ä»¥åŠå¸¸ç”¨å‘½ä»¤"></a>heroku å‘å¸ƒé¡¹ç›®æµç¨‹ä»¥åŠå¸¸ç”¨å‘½ä»¤</h3><ol><li>heroku login //ç™»å½•</li><li>git clone project</li><li>heroku create //åˆ›å»ºherokué¡¹ç›®</li><li>git push heroku master //å°†ä»£ç æäº¤åˆ°herokuæœåŠ¡å™¨ä¸Š</li><li><p>å£°æ˜ä¸€ä¸ªProcfile æ–‡ä»¶ç”¨æ¥æè¿°è¢«æ‰§è¡Œçš„å‘½ä»¤</p> <figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web: <span class="keyword">node</span> <span class="title">index</span>.js //web ä¸ºç¨‹åºç±»å‹ï¼Œè¯´æ˜æ˜¯webç¨‹åº</span><br></pre></td></tr></table></figure></li><li><p>heroku ps:scale web=1 //ç¡®ä¿æœ‰ä¸€ä¸ªé¡¹ç›®å®ä¾‹åœ¨è¿è¡Œ</p></li><li>heroku open //æ‰“å¼€é¡¹ç›®</li><li>heroku logs â€“tail //æŸ¥çœ‹é¡¹ç›®è¿è¡ŒçŠ¶æ€</li></ol><h3 id="äº‘æœåŠ¡ä½¿ç”¨æ•°æ®åº“"><a href="#äº‘æœåŠ¡ä½¿ç”¨æ•°æ®åº“" class="headerlink" title="äº‘æœåŠ¡ä½¿ç”¨æ•°æ®åº“"></a>äº‘æœåŠ¡ä½¿ç”¨æ•°æ®åº“</h3><p><a href="https://mlab.com/" target="_blank" rel="noopener">mlabé“¾æ¥</a></p><h4 id="è¿æ¥æ•°æ®åº“éœ€è¦æ³¨æ„"><a href="#è¿æ¥æ•°æ®åº“éœ€è¦æ³¨æ„" class="headerlink" title="è¿æ¥æ•°æ®åº“éœ€è¦æ³¨æ„"></a>è¿æ¥æ•°æ®åº“éœ€è¦æ³¨æ„</h4><ol><li>åˆ›å»ºæ•°æ®åº“æ—¶å€™ä¹Ÿè¦ä¸ºæ•°æ®åº“åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨æˆ·ï¼Œå¦åˆ™ä¼šæŠ¥éªŒè¯é”™è¯¯</li><li>å°†æœ¬åœ°æ•°æ®åº“é“¾æ¥æ”¹æˆè¿œç¨‹è¿æ¥</li></ol><h3 id="é¡µé¢503é—®é¢˜"><a href="#é¡µé¢503é—®é¢˜" class="headerlink" title="é¡µé¢503é—®é¢˜"></a>é¡µé¢503é—®é¢˜</h3><p><a href="https://devcenter.heroku.com/articles/error-pages" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a><br>heroku config:set<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku config:<span class="builtin-name">set</span> <span class="attribute">ERROR_PAGE_URL</span>=//sleepy-ravine-72939.herokuapp.com/</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;herokuå‚è€ƒæ–‡æ¡£&quot;&gt;&lt;a href=&quot;#herokuå‚è€ƒæ–‡æ¡£&quot; class=&quot;headerlink&quot; title=&quot;herokuå‚è€ƒæ–‡æ¡£&quot;&gt;&lt;/a&gt;herokuå‚è€ƒæ–‡æ¡£&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://devcenter.heroku.com/
      
    
    </summary>
    
    
      <category term="heroku" scheme="https://annilq.github.io/tags/heroku/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ flask åˆ›å»º todo api</title>
    <link href="https://annilq.github.io/2018/02/13/python-todo/"/>
    <id>https://annilq.github.io/2018/02/13/python-todo/</id>
    <published>2018-02-13T07:40:20.000Z</published>
    <updated>2018-02-23T11:32:35.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="é¡¹ç›®è¯´æ˜"><a href="#é¡¹ç›®è¯´æ˜" class="headerlink" title="é¡¹ç›®è¯´æ˜"></a>é¡¹ç›®è¯´æ˜</h4><p>ä¸€ä¸ªåç«¯ç”±flask ä¸ mongodbæä¾›restfulæ¥å£ï¼Œå‰ç«¯ç”±reactåˆ›å»ºçš„todo appé¡¹ç›®</p><ol><li><p>å‰ç«¯ <a href="https://github.com/annilq/react-todos" target="_blank" rel="noopener">é¡¹ç›®åœ°å€</a></p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/annilq/react-todos</span></span><br><span class="line">npm i</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure></li><li><p>flaskåªæä¾›restfulé£æ ¼çš„æ•°æ®æ¥å£</p><ol><li>codeè¯´æ˜<ol><li>0 æˆåŠŸ</li><li>-1 é”™è¯¯</li><li>-2 è¿‡æœŸ</li></ol></li></ol></li></ol><h4 id="åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ"><a href="#åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ"></a>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h4><ol><li><p>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒflask-server</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m venv flask-server</span><br></pre></td></tr></table></figure></li><li><p>è¿›å…¥python-todo-serverå¹¶åœ¨å½“å‰ç›®å½•æ¿€æ´»ç¯å¢ƒ(é€€å‡ºç¯å¢ƒå‘½ä»¤<code>deactivate</code>)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ./bin/activate</span><br></pre></td></tr></table></figure></li></ol><p><a href="https://docs.python.org/3/library/venv.html" target="_blank" rel="noopener">ç”¨venvå®‰è£…è™šæ‹Ÿç¯å¢ƒ</a></p><h4 id="å®‰è£…é¡¹ç›®ä¾èµ–"><a href="#å®‰è£…é¡¹ç›®ä¾èµ–" class="headerlink" title="å®‰è£…é¡¹ç›®ä¾èµ–"></a>å®‰è£…é¡¹ç›®ä¾èµ–</h4><ol><li><p>é¦–å…ˆå®‰è£…mongodb<br>å‚è€ƒ<a href="https://annilq.github.io/2016/04/18/mongoDb/">mongodbå°è®°</a></p></li><li><p>å®‰è£…ä¾èµ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pip install Flask</span><br><span class="line">pip install Flask-PyMongo</span><br><span class="line">pip install Flask-Session</span><br><span class="line">pip install Flask-Bcrypt</span><br><span class="line"><span class="comment">## è®°å½•ç¬¬ä¸‰æ–¹æ¨¡å—</span></span><br><span class="line">pip freeze &gt; requirements.txt</span><br><span class="line"><span class="comment">## å®‰è£…txtæ–‡ä»¶é‡Œæ‰€è®°å½•çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹æ¨¡å—</span></span><br><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure></li></ol><h4 id="é¡¹ç›®æ³¨æ„äº‹é¡¹"><a href="#é¡¹ç›®æ³¨æ„äº‹é¡¹" class="headerlink" title="é¡¹ç›®æ³¨æ„äº‹é¡¹"></a>é¡¹ç›®æ³¨æ„äº‹é¡¹</h4><ol><li>mongodbæŸ¥è¯¢çš„è¿”å›å€¼æ˜¯bsonæ•°æ®ç»“æ„,ä¸èƒ½ç›´æ¥ç”¨<code>flask</code>çš„<code>jsonify</code>ç›´æ¥è¿”å›<ol><li>éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰ä¸€ä¸ªæ–¹æ³•å°†æ•°æ®è¿”å› <a href="https://github.com/annilq/python/blob/master/others/flask-server/util.py" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></li><li>å°†æŸ¥è¯¢æ•°æ®ä¸­çš„<code>_id</code>ç”±<code>ObjectId</code>æ ¼å¼è½¬æˆ<code>str</code>æ ¼å¼è¿”å›</li></ol></li></ol><h4 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h4><ol><li><a href="http://api.mongodb.com/python/current/tutorial.html" target="_blank" rel="noopener">pymongo</a></li><li><a href="http://flask-pymongo.readthedocs.io/en/latest/#flask_pymongo.PyMongo" target="_blank" rel="noopener">flask-pymongo</a></li><li><a href="https://pythonhosted.org/Flask-Session/" target="_blank" rel="noopener">Flask-Session</a></li><li><a href="http://flask-bcrypt.readthedocs.io/en/latest/" target="_blank" rel="noopener">Flask-Bcrypt</a></li></ol><h4 id="é¡¹ç›®åœ°å€"><a href="#é¡¹ç›®åœ°å€" class="headerlink" title="é¡¹ç›®åœ°å€"></a>é¡¹ç›®åœ°å€</h4><p><a href="https://github.com/annilq/python/tree/master/others/flask-server" target="_blank" rel="noopener">flask-server</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;é¡¹ç›®è¯´æ˜&quot;&gt;&lt;a href=&quot;#é¡¹ç›®è¯´æ˜&quot; class=&quot;headerlink&quot; title=&quot;é¡¹ç›®è¯´æ˜&quot;&gt;&lt;/a&gt;é¡¹ç›®è¯´æ˜&lt;/h4&gt;&lt;p&gt;ä¸€ä¸ªåç«¯ç”±flask ä¸ mongodbæä¾›restfulæ¥å£ï¼Œå‰ç«¯ç”±reactåˆ›å»ºçš„todo appé¡¹ç›®&lt;/p&gt;
&lt;ol&gt;
      
    
    </summary>
    
    
      <category term="python flask" scheme="https://annilq.github.io/tags/python-flask/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯å¤„ç†å¤šä¸ªç›¸åŒajaxè¯·æ±‚é—®é¢˜</title>
    <link href="https://annilq.github.io/2018/01/31/ajax/"/>
    <id>https://annilq.github.io/2018/01/31/ajax/</id>
    <published>2018-01-31T09:36:01.000Z</published>
    <updated>2018-06-05T14:57:03.931Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h3><ol><li>é¦–å…ˆå®šä¹‰ä¸€ä¸ªurlçš„setï¼Œä¸€ä¸ªå‘èµ·è¯·æ±‚çš„åˆ—è¡¨</li></ol><h3 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h3><ol><li>å½“å‘èµ·ä¸€ä¸ªæ–°è¯·æ±‚</li><li>å½“å‘èµ·è¯·æ±‚ä¸€ä¸ªæ—¶å€™ï¼Œæ ¹æ®å‚æ•°ä¸urlç”Ÿæˆä¸€ä¸ªkey</li><li>åˆ¤æ–­å½“å‰keyæ˜¯å¦å­˜åœ¨urlçš„setä¸­<ol><li>ä¸å­˜åœ¨<ol><li>å°†å½“å‰keyæ·»åŠ åˆ°setä¸­ï¼Œè¡¨æ˜è¯¥è¯·æ±‚å·²ç»å‘å‡ºï¼Œå¹¶ä¸”æ ¹æ®keyç”Ÿæˆä¸€ä¸ªè¯¥è¯·æ±‚å¯¹åº”å¤„ç†å‡½æ•°çš„æ•°ç»„</li><li>éšåå‘å‡ºè¯¥è¯·æ±‚</li></ol></li><li>å­˜åœ¨<ol><li>è¿”å›ä¸€ä¸ªå¾…resolveçš„promiseï¼Œå¹¶ä¸”å°†è¯¥resolveæ–¹æ³•æ·»åŠ åˆ°åˆšåˆšç”Ÿæˆçš„è¯¥keyå¯¹åº”çš„å¤„ç†å‡½æ•°arrayä¸­</li></ol></li></ol></li><li>å½“è¯·æ±‚æˆåŠŸæ—¶å€™ï¼Œå¾ªç¯æ‰§è¡Œè¯¥keyå¯¹åº”çš„resolveæ–¹æ³•å°†æ•°æ®resolveå‡ºå»</li><li>æ¸…é™¤è¯¥å¤„ç†å‡½æ•°mapä¸­å¯¹åº”çš„keyï¼Œæ¸…é™¤å½“å‰setä¸­çš„å¯¹åº”çš„keyï¼Œä»¥ä¾¿ä¸‹æ¬¡é‡æ–°å‘èµ·è¯·æ±‚</li></ol><p>å…·ä½“ä»£ç å¦‚ä¸‹(å¦‚æœå¼•å…¥rx.js,å¤„ç†æ–¹æ³•ä¼šä¼˜é›…çš„å¤š)</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.urlsets = new Set();</span><br><span class="line">    <span class="keyword">this</span>.fullfill = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _generatorKey(url) &#123;</span><br><span class="line">    <span class="keyword">return</span> url</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ•°æ®å›æ¥åä¸€æ¬¡è°ƒç”¨å„ä¸ªpromise çš„resolve,å¹¶é‡ç½®å½“å‰çŠ¶æ€</span></span><br><span class="line">  handleFulfill(<span class="keyword">data</span>, key) &#123;</span><br><span class="line">    <span class="keyword">this</span>.fullfill[key].forEach(resolve =&gt; &#123;</span><br><span class="line">      resolve(<span class="keyword">data</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    delete <span class="keyword">this</span>.fullfill[key];</span><br><span class="line">    <span class="keyword">this</span>.urlsets.delete(key);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è·å–æ•°æ®ä¿¡æ¯</span></span><br><span class="line">  getConfigData(url) &#123;</span><br><span class="line">    let key = <span class="keyword">this</span>._generatorKey(url);</span><br><span class="line">    <span class="comment">// å¦‚æœè¯¥è¯·æ±‚è¿˜æ²¡æœ‰å›æ¥å°±å°†resolveæ–¹æ³•ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.urlsets.has(key)) &#123;</span><br><span class="line">      <span class="keyword">return</span> new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.fullfill[key].push(resolve);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// æ²¡æœ‰å½“å‰urlåˆ™å‘é€è¯·æ±‚</span></span><br><span class="line">      <span class="keyword">this</span>.urlsets.add(key);</span><br><span class="line">      <span class="keyword">this</span>.fullfill[key] = [];</span><br><span class="line">      <span class="keyword">return</span> axios.<span class="keyword">get</span>(url).then(<span class="keyword">data</span> =&gt; &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œä¹‹å‰ç¼“å­˜çš„resolveæ–¹æ³•ï¼Œå¹¶è¿”å›data</span></span><br><span class="line">        <span class="keyword">this</span>.handleFulfill(<span class="keyword">data</span>, key);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">data</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export <span class="keyword">default</span> new Store();</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ç»“æ„&quot;&gt;&lt;a href=&quot;#ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;ç»“æ„&quot;&gt;&lt;/a&gt;ç»“æ„&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¦–å…ˆå®šä¹‰ä¸€ä¸ªurlçš„setï¼Œä¸€ä¸ªå‘èµ·è¯·æ±‚çš„åˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;æµç¨‹&quot;&gt;&lt;a href=&quot;#æµç¨‹&quot; cla
      
    
    </summary>
    
    
      <category term="ajax å¹¶å‘" scheme="https://annilq.github.io/tags/ajax-%E5%B9%B6%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>PWAå°è®¡</title>
    <link href="https://annilq.github.io/2017/12/18/pwa/"/>
    <id>https://annilq.github.io/2017/12/18/pwa/</id>
    <published>2017-12-18T03:49:40.000Z</published>
    <updated>2017-12-22T11:17:37.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="PWAç®€ä»‹"><a href="#PWAç®€ä»‹" class="headerlink" title="PWAç®€ä»‹"></a>PWAç®€ä»‹</h3><p>PWA ï¼ˆ Progressive Web Appsï¼Œæ¸è¿›å¼ç½‘é¡µåº”ç”¨ï¼‰æ˜¯ç”±è°·æ­Œæå‡ºçš„æ–°ä¸€ä»£ Web åº”ç”¨æ¦‚å¿µï¼Œæ—¨åœ¨æä¾›å¯é ã€å¿«é€Ÿã€ç±»ä¼¼ Native åº”ç”¨çš„æœåŠ¡æ–¹æ¡ˆï¼ŒPWA æ­£åœ¨è¿…é€Ÿæˆä¸ºä¸€å¥—æœ€ä½³å®è·µã€‚</p><h3 id="PWAæ¶‰åŠçš„æŠ€æœ¯ç‚¹"><a href="#PWAæ¶‰åŠçš„æŠ€æœ¯ç‚¹" class="headerlink" title="PWAæ¶‰åŠçš„æŠ€æœ¯ç‚¹"></a>PWAæ¶‰åŠçš„æŠ€æœ¯ç‚¹</h3><ul><li>Service Worker</li><li>Web åº”ç”¨æ¸…å• manifest.json</li></ul><h3 id="Service-Worker"><a href="#Service-Worker" class="headerlink" title="Service Worker"></a>Service Worker</h3><p>Service workers æœ¬è´¨ä¸Šå……å½“Webåº”ç”¨ç¨‹åºä¸æµè§ˆå™¨ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥åœ¨ç½‘ç»œå¯ç”¨æ—¶ä½œä¸ºæµè§ˆå™¨å’Œç½‘ç»œé—´çš„ä»£ç†ã€‚ä»–ä»¬è¿˜å…è®¸è®¿é—®æ¨é€é€šçŸ¥å’Œåå°åŒæ­¥APIã€‚</p><p>Service Workerçš„ç”Ÿå‘½å‘¨æœŸ</p><ul><li>æ³¨å†Œ</li><li>å®‰è£…</li><li>æ¿€æ´»</li></ul><p>Service Workerçš„è¿è¡Œè¿‡ç¨‹</p><ul><li>æ£€æŸ¥å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒ Service Workers</li><li>å¦‚æœæ”¯æŒï¼Œæ³¨å†Œ Service Worker æ–‡ä»¶</li><li>æ¿€æ´»installäº‹ä»¶(ä¸€èˆ¬æ˜¯è¢«ç”¨æ¥å¡«å……ä½ çš„æµè§ˆå™¨çš„ç¦»çº¿ç¼“å­˜èƒ½åŠ›)<ul><li>event.waitUntil() :è¿™ä¼šç¡®ä¿Service Worker ä¸ä¼šåœ¨ waitUntil() é‡Œé¢çš„ä»£ç æ‰§è¡Œå®Œæ¯•ä¹‹å‰å®‰è£…å®Œæˆ</li></ul></li><li>æ¿€æ´»activateäº‹ä»¶</li><li>å¼€å§‹ç›‘å¬fetchäº‹ä»¶<ul><li>event.respondWith() åŠ«æŒæˆ‘ä»¬çš„ HTTP å“åº”ï¼Œç„¶åä½ ç”¨å¯ä»¥è‡ªå®šä¹‰Responseæ›´æ–°ä»–ä»¬ã€‚</li></ul></li></ul><h3 id="CacheStorage-apiä¸-Cache-å¯¹è±¡"><a href="#CacheStorage-apiä¸-Cache-å¯¹è±¡" class="headerlink" title="CacheStorage apiä¸ Cache å¯¹è±¡"></a>CacheStorage apiä¸ Cache å¯¹è±¡</h3><h4 id="CacheStorage-api"><a href="#CacheStorage-api" class="headerlink" title="CacheStorage api"></a>CacheStorage api</h4><ol><li>caches.open() æ‰“å¼€ä¸€ä¸ªCacheå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ª Promiseå¯¹è±¡ï¼Œresolveçš„ç»“æœæ˜¯ä¸€ä¸ªCacheå¯¹è±¡</li><li>caches.keys() åˆ é™¤ä¸€ä¸ªCacheå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ª Promiseå¯¹è±¡ï¼Œresolveçš„ç»“æœtrueåˆ™è¡¨ç¤ºæˆåŠŸ</li><li>caches.delete() è¿”å›ä¸€ä¸ª Promiseå¯¹è±¡ï¼Œresolveçš„ç»“æœæ˜¯ä¸€ä¸ªCacheå¯¹è±¡çš„æ•°ç»„</li></ol><h4 id="Cache-å¯¹è±¡"><a href="#Cache-å¯¹è±¡" class="headerlink" title="Cache å¯¹è±¡"></a>Cache å¯¹è±¡</h4><ol><li>cache.match(request, options) è¿”å›ä¸€ä¸ª Promiseå¯¹è±¡ï¼Œresolveçš„ç»“æœæ˜¯è·Ÿ Cache å¯¹è±¡åŒ¹é…çš„ç¬¬ä¸€ä¸ªå·²ç»ç¼“å­˜çš„è¯·æ±‚ã€‚</li><li>cache.matchAll(request, options) è¿”å›ä¸€ä¸ªPromise å¯¹è±¡ï¼Œresolveçš„ç»“æœæ˜¯è·ŸCacheå¯¹è±¡åŒ¹é…çš„æ‰€æœ‰è¯·æ±‚ç»„æˆçš„æ•°ç»„ã€‚</li><li>cache.add(request) æŠ“å–è¿™ä¸ªURL, æ£€ç´¢å¹¶æŠŠè¿”å›çš„responseå¯¹è±¡æ·»åŠ åˆ°ç»™å®šçš„Cacheå¯¹è±¡.è¿™åœ¨åŠŸèƒ½ä¸Šç­‰åŒäºè°ƒç”¨ fetch(), ç„¶åä½¿ç”¨ cache.put() å°†responseæ·»åŠ åˆ°cacheä¸­.</li><li>cache.addAll(requests) æŠ“å–ä¸€ä¸ªURLæ•°ç»„ï¼Œæ£€ç´¢å¹¶æŠŠè¿”å›çš„responseå¯¹è±¡æ·»åŠ åˆ°ç»™å®šçš„Cacheå¯¹è±¡ã€‚</li><li>cache.put(request, response) åŒæ—¶æŠ“å–ä¸€ä¸ªè¯·æ±‚åŠå…¶å“åº”ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç»™å®šçš„cacheã€‚</li><li>cache.delete(request, options) æœç´¢keyå€¼ä¸ºrequestçš„Cache æ¡ç›®ã€‚å¦‚æœæ‰¾åˆ°ï¼Œåˆ™åˆ é™¤è¯¥Cache æ¡ç›®ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªresolveä¸ºtrueçš„Promiseå¯¹è±¡ï¼›å¦‚æœæœªæ‰¾åˆ°ï¼Œåˆ™è¿”å›ä¸€ä¸ªresolveä¸ºfalseçš„Promiseå¯¹è±¡ã€‚</li><li>cache.keys(request, options) è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œresolveçš„ç»“æœæ˜¯Cacheå¯¹è±¡keyå€¼ç»„æˆçš„æ•°ç»„ã€‚<blockquote><ol><li>Cacheè¡¨ç¤ºç”¨äºRequest/Responseå¯¹è±¡å¯¹çš„å­˜å‚¨ï¼Œä½œä¸ºServiceWorkerç”Ÿå‘½å‘¨æœŸçš„ä¸€éƒ¨åˆ†è¢«ç¼“å­˜ã€‚</li><li>CacheStorage<br>è¡¨ç¤ºCacheå¯¹è±¡çš„å­˜å‚¨ã€‚æä¾›ä¸€ä¸ªæ‰€æœ‰å‘½åç¼“å­˜çš„ä¸»ç›®å½•ï¼ŒServiceWorkerå¯ä»¥è®¿é—®å¹¶ç»´æŠ¤åå­—å­—ç¬¦ä¸²åˆ°Cacheå¯¹è±¡çš„æ˜ å°„ã€‚</li></ol></blockquote></li></ol><h4 id="ä»£ç ä¸­æœ‰æ³¨é‡Š"><a href="#ä»£ç ä¸­æœ‰æ³¨é‡Š" class="headerlink" title="ä»£ç ä¸­æœ‰æ³¨é‡Š"></a>ä»£ç ä¸­æœ‰æ³¨é‡Š</h4><p><a href="https://github.com/annilq/blog/tree/master/jscode/pwa/sw.js" target="_blank" rel="noopener">sw.js</a></p><h3 id="Web-åº”ç”¨æ¸…å•-manifest-json"><a href="#Web-åº”ç”¨æ¸…å•-manifest-json" class="headerlink" title="Web åº”ç”¨æ¸…å• manifest.json"></a>Web åº”ç”¨æ¸…å• manifest.json</h3><ul><li>name:ç”¨ä½œå½“ç”¨æˆ·è¢«æç¤ºå®‰è£…åº”ç”¨æ—¶å‡ºç°çš„æ–‡æœ¬ã€‚</li><li>short_name :ç”¨ä½œå½“åº”ç”¨å®‰è£…åå‡ºç°åœ¨ç”¨æˆ·ä¸»å±å¹•ä¸Šçš„æ–‡æœ¬</li><li>start_url :å†³å®šäº†å½“ç”¨æˆ·ä»è®¾å¤‡çš„ä¸»å±å¹•å¼€å¯ Web åº”ç”¨æ—¶æ‰€å‡ºç°çš„ç¬¬ä¸€ä¸ªé¡µé¢ã€‚æœ¬ç« ç¨åä¼šè¯¦ç»†ä»‹ç»ã€‚<br>æ ¹æ®æ„å»ºçš„ Web åº”ç”¨ç±»å‹ï¼Œä½ å¯èƒ½éœ€è¦é¢„è®¾å¦‚ä½•é¦–æ¬¡åŠ è½½ã€‚display å­—æ®µè¡¨ç¤ºå¼€å‘è€…å¸Œæœ›ä»–ä»¬çš„ Web åº”ç”¨å¦‚ä½•å‘ç”¨æˆ·å±•ç¤ºã€‚æœ¬ç« ç¨åä¼šè¯¦ç»†ä»‹ç»ä¸ºä»€ä¹ˆè¿™ä¸ªå­—æ®µå¦‚æ­¤é‡è¦ã€‚</li><li>theme_color :å¯ä»¥å¯¹æµè§ˆå™¨çš„åœ°å€æ è¿›è¡Œç€è‰²ï¼Œä»¥ç¬¦åˆç½‘ç«™çš„ä¸»è‰²è°ƒã€‚<br>icons å­—æ®µå†³å®šäº†å½“ Web åº”ç”¨è¢«æ·»åŠ åˆ°è®¾å¤‡ä¸»å±å¹•æ—¶æ‰€æ˜¾ç¤ºçš„å›¾æ ‡ã€‚</li><li>background_color :name å’Œ background_color å±æ€§ç”¨æ¥æ˜¾ç¤ºå¯åŠ¨é¡µé¢</li><li>display: æ˜¾ç¤ºæ¨¡å¼<ol><li>Fullscreen - æ‰“å¼€ Web åº”ç”¨å¹¶å ç”¨æ•´ä¸ªå¯ç”¨çš„æ˜¾ç¤ºåŒºåŸŸã€‚</li><li>Standalone - æ‰“å¼€ Web åº”ç”¨ä»¥çœ‹èµ·æ¥åƒä¸€ä¸ªç‹¬ç«‹çš„åŸç”Ÿåº”ç”¨ã€‚æ­¤æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·ä»£ç†å°†æ’é™¤è¯¸å¦‚ URL æ ç­‰æ ‡å‡†æµè§ˆå™¨ UI å…ƒç´ ï¼Œä½†å¯ä»¥åŒ…æ‹¬è¯¸å¦‚çŠ¶æ€æ å’Œç³»ç»Ÿè¿”å›æŒ‰é’®çš„å…¶ä»–ç³»ç»Ÿ UI å…ƒç´ ã€‚</li><li>Minimal-ui - æ­¤æ¨¡å¼ç±»ä¼¼äº fullscreenï¼Œä½†ä¸ºç»ˆç«¯ç”¨æˆ·æä¾›äº†å¯è®¿é—®çš„æœ€å° UI å…ƒç´ é›†åˆï¼Œä¾‹å¦‚ï¼Œåé€€æŒ‰é’®ã€å‰è¿›æŒ‰é’®ã€é‡è½½æŒ‰é’®ä»¥åŠæŸ¥çœ‹ç½‘é¡µåœ°å€çš„ä¸€äº›æ–¹å¼ã€‚</li><li>Browser - ä½¿ç”¨æ“ä½œç³»ç»Ÿå†…ç½®çš„æ ‡å‡†æµè§ˆå™¨æ¥æ‰“å¼€ Web åº”ç”¨ã€‚</li></ol></li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/pwa/manifest.json" target="_blank" rel="noopener">manifest.json</a></p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ol><li><a href="http://sangka-z.com/PWA-Book-CN/" target="_blank" rel="noopener">Progressive Web Apps (PWA) ä¸­æ–‡ç‰ˆ</a></li><li><a href="https://zhuanlan.zhihu.com/p/25800461" target="_blank" rel="noopener">PWA åœ¨é¥¿äº†ä¹ˆçš„å®è·µç»éªŒ</a></li><li><a href="https://developers.google.com/web/fundamentals/primers/service-workers/" target="_blank" rel="noopener">æœåŠ¡å·¥ä½œçº¿ç¨‹ï¼šç®€ä»‹</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;PWAç®€ä»‹&quot;&gt;&lt;a href=&quot;#PWAç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;PWAç®€ä»‹&quot;&gt;&lt;/a&gt;PWAç®€ä»‹&lt;/h3&gt;&lt;p&gt;PWA ï¼ˆ Progressive Web Appsï¼Œæ¸è¿›å¼ç½‘é¡µåº”ç”¨ï¼‰æ˜¯ç”±è°·æ­Œæå‡ºçš„æ–°ä¸€ä»£ Web åº”ç”¨æ¦‚å¿µï¼Œæ—¨åœ¨æ
      
    
    </summary>
    
    
      <category term="PWA" scheme="https://annilq.github.io/tags/PWA/"/>
    
  </entry>
  
  <entry>
    <title>javascript æœç´¢ç®—æ³•</title>
    <link href="https://annilq.github.io/2017/12/07/serach/"/>
    <id>https://annilq.github.io/2017/12/07/serach/</id>
    <published>2017-12-07T08:04:40.000Z</published>
    <updated>2017-12-11T12:17:23.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•"><a href="#å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•" class="headerlink" title="å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•"></a>å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•</h3><ol><li>é¡ºåºæœç´¢</li><li>äºŒåˆ†æœç´¢</li></ol><h3 id="é¡ºåºæœç´¢"><a href="#é¡ºåºæœç´¢" class="headerlink" title="é¡ºåºæœç´¢"></a>é¡ºåºæœç´¢</h3><p>é¡ºåºæˆ–çº¿æ€§æœç´¢æ˜¯æœ€åŸºæœ¬çš„æœç´¢ç®—æ³•ã€‚å®ƒçš„æœºåˆ¶æ˜¯ï¼Œå°†æ¯ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ å’Œæˆ‘ä»¬è¦æ‰¾çš„å…ƒç´ åšæ¯”è¾ƒã€‚é¡ºåºæœç´¢æ˜¯æœ€ä½æ•ˆçš„ä¸€ç§æœç´¢ç®—æ³•</p><h3 id="äºŒåˆ†æœç´¢"><a href="#äºŒåˆ†æœç´¢" class="headerlink" title="äºŒåˆ†æœç´¢"></a>äºŒåˆ†æœç´¢</h3><p>é€‰æ‹©æ’åºå¤§è‡´æ€è·¯æ˜¯æ‰¾åˆ°æ•°æ®ç»“æ„æœ€å°å€¼å¹¶å°†å…¶æ”¾ç½®åˆ°ç¬¬ä¸€ä½ï¼Œæ¥ç€æ‰¾åˆ°ç¬¬äºŒå°çš„å€¼æ”¾åˆ°ç¬¬äºŒä½ï¼Œä»¥æ­¤ç±»æ¨<br>è¿™ä¸ªç®—æ³•è¦æ±‚è¢«æœç´¢çš„æ•°æ®ç»“æ„å·²æ’åº</p><p>  ç®—æ³•æ­¥éª¤</p><ol><li>é€‰æ‹©æ•°ç»„çš„ä¸­é—´å€¼</li><li>å¦‚æœé€‰ä¸­çš„æ˜¯å¾…æœç´¢å€¼ï¼Œé‚£ä¹ˆç®—æ³•æ‰§è¡Œå®Œæ¯•</li><li>å¦‚æœå¾…æœç´¢çš„å€¼æ¯”é€‰ä¸­å€¼è¦å°ï¼Œåˆ™è¿”å›æ­¥éª¤1å¹¶é€‰æ‹©å€¼å·¦è¾¹çš„å­æ•°ç»„ä¸­å¯»æ‰¾</li><li>å¦‚æœå¾…æœç´¢çš„å€¼æ¯”é€‰ä¸­å€¼è¦å¤§ï¼Œåˆ™è¿”å›æ­¥éª¤1å¹¶é€‰æ‹©å€¼å³è¾¹çš„å­æ•°ç»„ä¸­å¯»æ‰¾</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•&quot;&gt;&lt;a href=&quot;#å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•&quot; class=&quot;headerlink&quot; title=&quot;å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•&quot;&gt;&lt;/a&gt;å‡ ç§å¸¸è§çš„æœç´¢ç®—æ³•&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¡ºåºæœç´¢&lt;/li&gt;
&lt;li&gt;äºŒåˆ†æœç´¢&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id
      
    
    </summary>
    
    
      <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="https://annilq.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>javascriptæ’åº</title>
    <link href="https://annilq.github.io/2017/12/01/sort/"/>
    <id>https://annilq.github.io/2017/12/01/sort/</id>
    <published>2017-12-01T09:01:40.000Z</published>
    <updated>2017-12-22T11:17:37.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‡ ç§å¸¸è§çš„æ’åºç®—æ³•"><a href="#å‡ ç§å¸¸è§çš„æ’åºç®—æ³•" class="headerlink" title="å‡ ç§å¸¸è§çš„æ’åºç®—æ³•"></a>å‡ ç§å¸¸è§çš„æ’åºç®—æ³•</h3><ol><li>å†’æ³¡æ’åº</li><li>é€‰æ‹©æ’åº</li><li>æ’å…¥æ’åº</li><li>å½’å¹¶æ’åº</li><li>å¿«é€Ÿæ’åº</li></ol><h3 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h3><p>å†’æ³¡æ’åºæ˜¯æ¯”è¾ƒä»»ä½•ç›¸é‚»çš„ä¸¤ä¸ªé¡¹ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§åˆ™äº¤æ¢ä»–ä»¬</p><h3 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h3><p>é€‰æ‹©æ’åºå¤§è‡´æ€è·¯æ˜¯æ‰¾åˆ°æ•°æ®ç»“æ„æœ€å°å€¼å¹¶å°†å…¶æ”¾ç½®åˆ°ç¬¬ä¸€ä½ï¼Œæ¥ç€æ‰¾åˆ°ç¬¬äºŒå°çš„å€¼æ”¾åˆ°ç¬¬äºŒä½ï¼Œä»¥æ­¤ç±»æ¨</p><h3 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h3><p>æ’å…¥æ’åºæ˜¯æ¯æ¬¡æ’å‡ºä¸€ä¸ªæ•°ç»„é¡¹ï¼Œä¾æ¬¡æ–¹å¼æ„å»ºæœ€åçš„æ’åºæ•°ç»„ï¼Œå‡å®šç¬¬ä¸€é¡¹å·²ç»æ’åºäº†ï¼Œæ¥ç€ä»–å’Œç¬¬äºŒé¡¹åšæ¯”è¾ƒï¼Œç¬¬äºŒé¡¹æ˜¯åº”è¯¥æ’åˆ°åŸä½è¿˜æ˜¯ç¬¬ä¸€é¡¹ä¹‹å‰å‘¢ï¼Œä»¥æ­¤ç±»æ¨</p><h3 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h3><p>å½’å¹¶æ’åºæ˜¯ä¸€ç§åˆ†æ²»ç®—æ³•ï¼Œå…¶æ€æƒ³æ˜¯å°†åŸå§‹æ•°ç»„åˆ‡åˆ†æˆè¾ƒå°çš„æ•°ç»„ï¼Œç›´åˆ°æ¯ä¸ªå°æ•°ç»„åªæœ‰ä¸€ä¸ªä½ç½®ï¼Œæ¥ç€å°†å°æ•°ç»„å½’å¹¶æˆè¾ƒå¤§çš„æ•°ç»„ï¼Œç›´åˆ°æœ€åä¸€ä¸ªåªæœ‰ä¸€ä¸ªæ’åºå®Œæ¯•çš„å¤§æ•°ç»„</p><h3 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h3><p>å¿«é€Ÿæ’åºä¹Ÿä½¿ç”¨åˆ†æ²»çš„æ–¹æ³•ï¼Œå°†åŸå§‹æ•°ç»„åˆ‡åˆ†æˆè¾ƒå°çš„æ•°ç»„</p><h4 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h4><ul><li>é¦–å…ˆï¼Œä»æ•°ç»„ä¸­é—´é€‰å‡ºä¸€ä¸ªä¸»å…ƒã€‚</li><li>åˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆï¼Œå·¦è¾¹ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€é¡¹ï¼Œå³è¾¹æŒ‡å‘æ•°ç»„çš„æœ€åä¸€é¡¹ã€‚ç§»åŠ¨æŒ‡é’ˆç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ¯”ä¸»å…ƒå¤§çš„å…ƒç´ ï¼Œæ¥ç€ï¼Œç§»åŠ¨å³æŒ‡é’ˆç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ¯”ä¸»å…ƒå°çš„å…ƒç´ ï¼Œç„¶åäº¤æ¢ä»–ä»¬ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°å·¦æŒ‡é’ˆè¶…è¿‡äº†å³æŒ‡é’ˆã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä½¿æ¯”ä¸»å…ƒå°çš„å€¼éƒ½åœ¨ä¸»å…ƒçš„å·¦ä¾§ï¼Œæ¯”ä¸»å…ƒå¤§çš„å€¼éƒ½åœ¨å³ä¾§ï¼Œè¿™ä¸€è¿‡ç¨‹å«åšåˆ’åˆ†æ“ä½œ</li><li>æ¥ç€ï¼Œç®—æ³•å¯¹åˆ’åˆ†çš„å°æ•°ç»„é‡å¤ä¹‹å‰çš„ä¸¤ä¸ªæ“ä½œï¼Œç›´åˆ°æ•°ç»„å·²ç»å®Œå…¨æ’åº</li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/sort/sort.js" target="_blank" rel="noopener">code</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;å‡ ç§å¸¸è§çš„æ’åºç®—æ³•&quot;&gt;&lt;a href=&quot;#å‡ ç§å¸¸è§çš„æ’åºç®—æ³•&quot; class=&quot;headerlink&quot; title=&quot;å‡ ç§å¸¸è§çš„æ’åºç®—æ³•&quot;&gt;&lt;/a&gt;å‡ ç§å¸¸è§çš„æ’åºç®—æ³•&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;å†’æ³¡æ’åº&lt;/li&gt;
&lt;li&gt;é€‰æ‹©æ’åº&lt;/li&gt;
&lt;li&gt;æ’å…¥æ’åº&lt;/li
      
    
    </summary>
    
    
      <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="https://annilq.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>javascriptæ•°æ®ç»“æ„</title>
    <link href="https://annilq.github.io/2017/11/29/datastructures/"/>
    <id>https://annilq.github.io/2017/11/29/datastructures/</id>
    <published>2017-11-29T15:22:40.000Z</published>
    <updated>2017-12-22T11:17:37.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„"><a href="#å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„" class="headerlink" title="å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„"></a>å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„</h3><ol><li>Stackæ ˆ</li><li>Queueé˜Ÿåˆ—</li><li>LinkedListé“¾è¡¨</li><li>Seté›†åˆ</li><li>Mapå­—å…¸ã€æ•£åˆ—è¡¨</li><li>Treeæ ‘</li><li>å›¾(è¿˜ä¸ç†è§£)</li></ol><h3 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h3><p>æ ˆæ˜¯ä¸€ç§éµä»åè¿›å…ˆå‡ºåŸåˆ™çš„æœ‰åºé›†åˆ</p><ul><li>push(value): æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ åˆ°æ ˆé¡¶</li><li>pop(): ç§»é™¤æ ˆé¡¶çš„å…ƒç´ ï¼Œå¹¶ä¸”è¿”å›ç§»é™¤çš„å…ƒç´ </li><li>peek(): è¿”å›æ ˆé¡¶çš„å…ƒç´ </li><li>isEmpty(): åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º</li><li>clear():æ¸…ç©ºæ ˆ</li><li>size(): è¿”å›æ ˆå…ƒç´ ä¸ªæ•°</li></ul><p>åº”ç”¨ï¼šåè¿›åˆ¶è½¬æ¢äºŒè¿›åˆ¶</p><p><a href="https://github.com/annilq/blog/tree/master/jscode/datastructrues/stack.js" target="_blank" rel="noopener">stack code</a></p><h3 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h3><p>é˜Ÿåˆ—æ˜¯éµä»å…ˆè¿›å…ˆå‡ºåŸåˆ™çš„ä¸€ç»„æœ‰åºé›†åˆ</p><ul><li>enqueue(value): å‘é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ æ–°å…ƒç´ </li><li>dequeue(): ç§»é™¤é˜Ÿåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ </li><li>front(): è¿”å›é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>isEmpty(): åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º</li><li><p>size(): è¿”å›é˜Ÿåˆ—çš„å…ƒç´ ä¸ªæ•°</p><p>å…¶ä»–ä¿®æ”¹ç‰ˆæœ¬çš„é˜Ÿåˆ—å®ç°</p></li><li>ä¼˜å…ˆé˜Ÿåˆ— åº”ç”¨ï¼šåŒ»é™¢æ’é˜Ÿ<blockquote><p>éœ€è¦æ„å»ºä¸€ä¸ªåŒ…å«ä¼˜å…ˆçº§çš„å…ƒç´ </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Node=<span class="function"><span class="keyword">function</span>(<span class="params">element,priority</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.element=element;</span><br><span class="line">  <span class="keyword">this</span>.priority=priority;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote></li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/datastructrues/queue.js" target="_blank" rel="noopener">queue code</a></p><h3 id="LinkedList"><a href="#LinkedList" class="headerlink" title="LinkedList"></a>LinkedList</h3><p>é“¾è¡¨æ˜¯æœ‰åºçš„å…ƒç´ é›†åˆï¼Œä¸åŒäºé›†åˆï¼Œé“¾è¡¨ä¸­çš„å…ƒç´ åœ¨å†…å­˜ä¸­ä¸æ˜¯è¿ç»­æ”¾ç½®çš„ï¼Œæ¯ä¸ªå…ƒç´ ç”±ä¸€ä¸ªå­˜å‚¨å…ƒç´ æœ¬èº«çš„èŠ‚ç‚¹å’Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ç»„æˆ</p><ul><li>append(element): å‘é“¾è¡¨å°¾å¤„æ·»åŠ ä¸€ä¸ªå…ƒç´ </li><li>insert(position,element): å‘æŒ‡å®šä½ç½®æ·»åŠ ä¸€ä¸ªå…ƒç´ </li><li>remove(element): ç§»é™¤æŒ‡å®šå…ƒç´ </li><li>indexOf(element): è¿”å›å…ƒç´ åœ¨é“¾è¡¨ä¸­çš„ç´¢å¼•</li><li>removeAt(position): ç§»é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ </li><li>isEmpty(): åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©º</li><li>size(): è¿”å›é“¾è¡¨å…ƒç´ ä¸ªæ•°</li><li><p>toString(): ç”±äºé“¾è¡¨é¡¹ä½¿ç”¨äº†Nodeç±»ï¼Œå°±éœ€è¦é‡å†™ç»§æ‰¿è‡ªjavascriptå¯¹è±¡é»˜è®¤çš„toStringæ–¹æ³•ï¼Œè®©å…¶åªè¾“å‡ºå…ƒç´ çš„å€¼</p><p>å…¶ä»–ä¿®æ”¹ç‰ˆæœ¬çš„é˜Ÿåˆ—å®ç°</p></li><li><p>åŒå‘é“¾è¡¨ :åŒå‘é“¾è¡¨ä¸­é“¾æ¥æ˜¯åŒå‘çš„ï¼Œä¸€ä¸ªé“¾æ¥å‘ä¸Šçš„ä¸€ä¸ªé“¾æ¥å‘ä¸‹çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Node=<span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.element=element;</span><br><span class="line">  <span class="keyword">this</span>.prev=<span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">this</span>.next=<span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å¾ªç¯é“¾è¡¨ :å¾ªç¯é“¾è¡¨ä¸é“¾è¡¨çš„å”¯ä¸€åŒºåˆ«åœ¨äº,æœ€åä¸€ä¸ªå…ƒç´ æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆä¸æ˜¯null,è€Œæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ head</p><blockquote><p>ps:ä½¿ç”¨Stack ã€Queueä¸LinkedListä¹‹é—´çš„åŒºåˆ«</p><ul><li>Stack ã€Queueç›¸å¯¹äºé“¾è¡¨æ¥è¯´æ•°æ®ç»“æ„ç®€å•ï¼Œå¹¶ä¸”(å†å¤§å¤šæ•°è¯­è¨€ä¸­)æ•°ç»„çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œä¸å®¹æ˜“æ‰©å®¹ï¼Œé“¾è¡¨å¯ä»¥åŠ¨æ€æ‰©å®¹</li><li>ä»Stack ã€Queueèµ·ç‚¹æˆ–ä¸­é—´æ’å…¥æˆ–ç§»é™¤å…ƒç´ æˆæœ¬éå¸¸é«˜ï¼Œå› ä¸ºéœ€è¦ç§»åŠ¨å…ƒç´ ï¼Œè€Œé“¾è¡¨ä¸éœ€è¦ç§»åŠ¨å…ƒç´ </li></ul></blockquote></li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/datastructrues/linkedlist.js" target="_blank" rel="noopener">linkedlist code</a></p><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>é›†åˆæ˜¯ä»¥[å€¼,å€¼]çš„å½¢å¼å‚¨å­˜å…ƒç´ ï¼Œæ˜¯ç”±ä¸€ç»„æ— åºä¸”å”¯ä¸€çš„é¡¹ç»„æˆçš„</p><p>  é›†åˆæ–¹æ³•</p><ul><li>add(value): æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°é›†åˆä¸­</li><li>delete(value): åˆ é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ </li><li>has(value): åˆ¤æ–­å€¼æ˜¯å¦åœ¨é›†åˆä¸­</li><li>clear(): æ¸…ç©ºé›†åˆ</li><li>size(): è¿”å›é›†åˆä¸­çš„å…ƒç´ æ•°é‡</li><li><p>values(): è¿”å›ä¸€ä¸ªåŒ…å«é›†åˆä¸­æ‰€æœ‰å€¼çš„æ•°ç»„</p><p>é›†åˆæ“ä½œ</p></li><li>union å¹¶é›†</li><li>intersection äº¤é›†</li><li>difference å·®é›†</li><li>subset å­é›†</li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/datastructrues/set.js" target="_blank" rel="noopener">Set code</a></p><h3 id="Map-HashMap"><a href="#Map-HashMap" class="headerlink" title="Map,HashMap"></a>Map,HashMap</h3><h4 id="Mapæ˜¯ä»¥-é”®-å€¼-çš„å½¢å¼å‚¨å­˜å…ƒç´ "><a href="#Mapæ˜¯ä»¥-é”®-å€¼-çš„å½¢å¼å‚¨å­˜å…ƒç´ " class="headerlink" title="Mapæ˜¯ä»¥[é”®,å€¼]çš„å½¢å¼å‚¨å­˜å…ƒç´ "></a>Mapæ˜¯ä»¥[é”®,å€¼]çš„å½¢å¼å‚¨å­˜å…ƒç´ </h4><p>  Mapæ–¹æ³•</p><ul><li>set(key,value):å‘å­—å…¸ä¸­æ·»åŠ å…ƒç´ </li><li>delete(key):åˆ é™¤å­—å…¸ä¸­æŒ‡å®šçš„key</li><li>get(key):è·å–æŒ‡å®škeyçš„value</li><li>clear():æ¸…ç©ºå­—å…¸</li><li>size():è¿”å›å­—å…¸ä¸­å…ƒç´ ä¸ªæ•°</li><li>keys():ä»¥æ•°ç»„å½¢å¼è¿”å›å­—å…¸ä¸­æ‰€æœ‰çš„å…ƒç´ çš„é”®</li><li>values():ä»¥æ•°ç»„å½¢å¼è¿”å›å­—å…¸ä¸­æ‰€æœ‰çš„å…ƒç´ çš„å€¼</li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/datastructrues/map.js" target="_blank" rel="noopener">Map code</a></p><h4 id="HashMapçš„ä½œç”¨æ˜¯å°½å¯èƒ½å¿«åœ°åœ¨æ•°æ®ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ï¼Œä½¿ç”¨HashMapå¯ä»¥çŸ¥é“è¯¥å€¼çš„å…·ä½“ä½ç½®è€Œä¸éœ€è¦éå†"><a href="#HashMapçš„ä½œç”¨æ˜¯å°½å¯èƒ½å¿«åœ°åœ¨æ•°æ®ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ï¼Œä½¿ç”¨HashMapå¯ä»¥çŸ¥é“è¯¥å€¼çš„å…·ä½“ä½ç½®è€Œä¸éœ€è¦éå†" class="headerlink" title="HashMapçš„ä½œç”¨æ˜¯å°½å¯èƒ½å¿«åœ°åœ¨æ•°æ®ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ï¼Œä½¿ç”¨HashMapå¯ä»¥çŸ¥é“è¯¥å€¼çš„å…·ä½“ä½ç½®è€Œä¸éœ€è¦éå†"></a>HashMapçš„ä½œç”¨æ˜¯å°½å¯èƒ½å¿«åœ°åœ¨æ•°æ®ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ï¼Œä½¿ç”¨HashMapå¯ä»¥çŸ¥é“è¯¥å€¼çš„å…·ä½“ä½ç½®è€Œä¸éœ€è¦éå†</h4><p>HashMapæ–¹æ³•</p><ul><li>put(key,value)</li><li>get(key)</li><li>remove(key)</li></ul><h5 id="HashMapçš„åˆ›å»ºéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ éƒ¨åˆ†"><a href="#HashMapçš„åˆ›å»ºéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ éƒ¨åˆ†" class="headerlink" title="HashMapçš„åˆ›å»ºéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ éƒ¨åˆ†"></a>HashMapçš„åˆ›å»ºéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ éƒ¨åˆ†</h5><ul><li>æ•£åˆ—å‡½æ•° å¯ä»¥å°†é”®å€¼è½¬æ¢æˆæ•°å­—ç”¨æ¥è®°å½•è¯¥å€¼åœ¨æ•°æ®ç»“æ„ä¸­çš„ä½ç½®</li><li>å¤„ç†æ•£åˆ—è¡¨ä¸­çš„å†²çª<ul><li>åˆ†ç¦»é“¾æ¥ï¼šç”¨é“¾è¡¨æ¥å­˜å‚¨æŸä¸ªä½ç½®çš„å€¼</li><li>çº¿æ€§æ¢ç´¢:å½“æŸä¸ªä½ç½®indexå·²ç»è¢«å æ®æ—¶å€™ï¼Œåˆ™å°è¯•index+1çš„ä½ç½®ï¼Œä»¥æ­¤ç±»æ¨</li></ul></li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/datastructrues/hashmap.js" target="_blank" rel="noopener">HashMap code</a></p><h3 id="Tree"><a href="#Tree" class="headerlink" title="Tree"></a>Tree</h3><p>æ ‘æ˜¯ä¸€ç§åˆ†å±‚æ•°æ®çš„æŠ½è±¡æ¨¡å‹ï¼Œæ ‘ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å«åšèŠ‚ç‚¹ï¼Œä½äºæ ‘é¡¶éƒ¨çš„èŠ‚ç‚¹å«æ ¹èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ï¼ˆæ ¹èŠ‚ç‚¹é™¤å¤–ï¼‰éƒ½æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ä»¥åŠé›¶ä¸ªæˆ–è€…å¤šä¸ªå­èŠ‚ç‚¹</p><ul><li>insert(key):å‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªå€¼</li><li>search(key):åœ¨æ ‘ä¸­æŸ¥æ‰¾ä¸€ä¸ªå€¼ï¼Œè¿”å›true or false</li><li>inOrderTraverse():ä¸­åºéå†æ ‘èŠ‚ç‚¹,æ˜¯ä¸€ç§ä»å°åˆ°å¤§çš„é¡ºåºè®¿é—®æ‰€æœ‰èŠ‚ç‚¹</li><li>preOrderTraverse():å…ˆåºéå†æ ‘èŠ‚ç‚¹,æ˜¯ä¸€ç§ä¼˜å…ˆäºåä»£èŠ‚ç‚¹çš„é¡ºåºè®¿é—®æ¯ä¸ªèŠ‚ç‚¹</li><li>postOrderTraverse():ååºéå†æ ‘èŠ‚ç‚¹ï¼Œæ˜¯å…ˆè®¿é—®èŠ‚ç‚¹çš„åä»£èŠ‚ç‚¹ï¼Œåœ¨è®¿é—®èŠ‚ç‚¹æœ¬èº«</li><li>min():è¿”å›æ ‘ä¸­æœ€å°å€¼</li><li>max():è¿”å›æ ‘ä¸­æœ€å¤§å€¼</li><li>remove(key):ä»æ ‘ä¸­ç§»é™¤æŸä¸ªå€¼</li></ul><p><a href="https://github.com/annilq/blog/tree/master/jscode/datastructrues/BinarySearchTree.js" target="_blank" rel="noopener">BinarySearchTree code</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„&quot;&gt;&lt;a href=&quot;#å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„&quot;&gt;&lt;/a&gt;å‡ ç§å¸¸è§çš„æ•°æ®ç»“æ„&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;Stackæ ˆ&lt;/li&gt;
&lt;li&gt;Queueé˜Ÿåˆ—&lt;/li&gt;
&lt;li&gt;Lin
      
    
    </summary>
    
    
      <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="https://annilq.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>RxJS å°è®°</title>
    <link href="https://annilq.github.io/2017/11/09/rxjs/"/>
    <id>https://annilq.github.io/2017/11/09/rxjs/</id>
    <published>2017-11-09T11:30:01.000Z</published>
    <updated>2017-11-09T11:35:39.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç®€å•æ¥è¯´-Observableæ˜¯ä¸€ä¸ªæ¥æ”¶observerå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯ç”¨äºå–æ¶ˆè®¢é˜…æ–¹æ³•çš„æ–¹æ³•"><a href="#ç®€å•æ¥è¯´-Observableæ˜¯ä¸€ä¸ªæ¥æ”¶observerå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯ç”¨äºå–æ¶ˆè®¢é˜…æ–¹æ³•çš„æ–¹æ³•" class="headerlink" title="ç®€å•æ¥è¯´ Observableæ˜¯ä¸€ä¸ªæ¥æ”¶observerå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯ç”¨äºå–æ¶ˆè®¢é˜…æ–¹æ³•çš„æ–¹æ³•"></a>ç®€å•æ¥è¯´ Observableæ˜¯ä¸€ä¸ªæ¥æ”¶observerå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯ç”¨äºå–æ¶ˆè®¢é˜…æ–¹æ³•çš„æ–¹æ³•</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¯”è¾ƒåŸºç¡€çš„å®ç°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myObservable</span>(<span class="params">observer</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> datasource = <span class="keyword">new</span> DataSource();</span><br><span class="line">    datasource.ondata = <span class="function">(<span class="params">e</span>) =&gt;</span> observer.next(e);</span><br><span class="line">    datasource.onerror = <span class="function">(<span class="params">err</span>) =&gt;</span> observer.error(err);</span><br><span class="line">    datasource.oncomplete = <span class="function"><span class="params">()</span> =&gt;</span> observer.complete();</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        datasource.destroy();</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸€ä¸ªå¥å…¨ä¸€ç‚¹çš„è§‚å¯Ÿè€…åº”è¯¥ä¿è¯ä»¥ä¸‹å‡ ç‚¹</p><ol><li><code>next</code>ï¼Œ<code>error</code>å’Œ<code>complete</code>å®é™…ä¸Šéƒ½æ˜¯å¯é€‰çš„ã€‚ä½ ä¸å¿…å¤„ç†æ¯ä¸ªå€¼ï¼Œæˆ–é”™è¯¯æˆ–å®Œæˆã€‚</li><li>ä½ ä¸èƒ½åœ¨<code>complete</code>å’Œ<code>error</code>ä¹‹åè°ƒç”¨next</li><li>è°ƒç”¨<code>complete</code>å’Œ<code>error</code>åéœ€è¦è°ƒç”¨å–æ¶ˆè®¢é˜…é€»è¾‘ã€‚</li><li>åªæœ‰æ‰§è¡Œè®¢é˜…æ–¹æ³•,æ‰ä¼šæ¥æ”¶åˆ°æ•°æ®æºçš„å€¼</li><li>å¦‚æœä½ çš„<code>next</code>,<code>complete</code>æˆ–<code>error</code>å¤„ç†ç¨‹åºæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œä½ æƒ³è°ƒç”¨ä½ çš„å–æ¶ˆè®¢é˜…é€»è¾‘ã€‚</li></ol><h3 id="å®ç°ä¸€ä¸ªç±»RxJSéœ€è¦å®ç°ä»¥ä¸‹å‡ éƒ¨åˆ†"><a href="#å®ç°ä¸€ä¸ªç±»RxJSéœ€è¦å®ç°ä»¥ä¸‹å‡ éƒ¨åˆ†" class="headerlink" title="å®ç°ä¸€ä¸ªç±»RxJSéœ€è¦å®ç°ä»¥ä¸‹å‡ éƒ¨åˆ†"></a>å®ç°ä¸€ä¸ªç±»RxJSéœ€è¦å®ç°ä»¥ä¸‹å‡ éƒ¨åˆ†</h3><ol><li>æ•°æ®æº</li><li>observer</li><li>Observableç”Ÿæˆå™¨</li><li>observable</li><li>operator</li></ol><h4 id="æ•°æ®æº"><a href="#æ•°æ®æº" class="headerlink" title="æ•°æ®æº"></a>æ•°æ®æº</h4><ul><li>æ•°æ®æºå¯ä»¥äº§ç”Ÿæ•°æ®ç»™observer</li></ul><h4 id="observer"><a href="#observer" class="headerlink" title="observer"></a>observer</h4><ul><li>åŒ…å«  <code>next</code>, <code>error</code> and <code>complete</code> å±æ€§çš„å¯¹è±¡ï¼Œç”¨æ¥å¤„ç†æ•°æ®æºçš„æ•°æ®</li></ul><h4 id="Observable-ç”Ÿæˆå™¨å‡½æ•°"><a href="#Observable-ç”Ÿæˆå™¨å‡½æ•°" class="headerlink" title="Observable ç”Ÿæˆå™¨å‡½æ•°"></a>Observable ç”Ÿæˆå™¨å‡½æ•°</h4><ul><li>æ¥æ”¶ä¸€ä¸ªobserverå¯¹è±¡(è¯¥observerç”±observableä¼ å…¥å¹¶ä¸”ç»è¿‡åŒ…è£…åå¾—åˆ°)ï¼Œå¹¶ä¸”å°†observerå’Œæ•°æ®æºå…³è”</li></ul><h4 id="observable"><a href="#observable" class="headerlink" title="observable"></a>observable</h4><ul><li>ç”±Observableç”Ÿæˆå™¨å‡½æ•°ç”Ÿæˆï¼Œå¹¶å¸¦æœ‰ä¸€ä¸ªæ¥æ”¶observerå¯¹è±¡çš„subscribeæ–¹æ³•</li></ul><h4 id="operator"><a href="#operator" class="headerlink" title="operator"></a>operator</h4><ul><li>æ“ä½œç¬¦æ˜¯ä¸€ä¸ªæ¥æ”¶observableå¹¶ä¸”è¿”å›æ–°observableçš„å‡½æ•°</li><li>æ“ä½œç¬¦åœ¨åšä»€ä¹ˆï¼šå½“ä½ è®¢é˜…å®ƒçš„è¿”å›çš„observableæ—¶ï¼Œå®ƒåˆ›å»ºä¸€ä¸ª<code>mapObserver</code>æ¥å®Œæˆå·¥ä½œå¹¶å°†<code>observer</code>å’Œ<code>mapObserver</code>é“¾æ¥åœ¨ä¸€èµ·ã€‚å»ºç«‹operatorå®é™…ä¸Šåªæ˜¯åˆ›å»ºä¸€ä¸ªç”¨äºåœ¨è®¢é˜…æ—¶è¿æ¥è§‚å¯Ÿè€…çš„æ¨¡æ¿</li></ul><h2 id="Observableæ‰§è¡Œé¡ºåº"><a href="#Observableæ‰§è¡Œé¡ºåº" class="headerlink" title="Observableæ‰§è¡Œé¡ºåº"></a>Observableæ‰§è¡Œé¡ºåº</h2><ol><li>Observableç”Ÿæˆå™¨å‡½æ•°ç”Ÿæˆä¸€ä¸ªobservable</li><li>observableè°ƒç”¨subscribeæ—¶ä¼ å…¥ä¸€ä¸ªobserverï¼Œå¹¶è¿”å›ä¸€ä¸ªè®¢é˜…Subscriptionå¯¹è±¡</li><li>å°†observerä¸æ•°æ®æºå…³è”</li><li>æ•°æ®æºå‘å‡ºæ•°æ®æ—¶è°ƒç”¨observerç›¸å…³æ–¹æ³•</li><li>å¯ä»¥è°ƒç”¨è®¢é˜…å¯¹è±¡Subscriptionçš„unsubscribeæ–¹æ³•å–æ¶ˆè®¢é˜…</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  -------------------------------DataSource----------------------------</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventDataSource</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">this</span>._id = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.emit(i++), <span class="number">200</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  emit(n) &#123;</span><br><span class="line">    <span class="keyword">const</span> limit = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.ondata) &#123;</span><br><span class="line">      <span class="keyword">this</span>.ondata(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n === limit) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.oncomplete) &#123;</span><br><span class="line">        <span class="keyword">this</span>.oncomplete();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.destroy();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  destroy() &#123;</span><br><span class="line">    clearInterval(<span class="keyword">this</span>._id);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ArraySource=[<span class="string">"hello"</span>, <span class="string">"annilq"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PromiseSource=<span class="built_in">Promise</span>.resolve(<span class="string">"promise"</span>);</span><br><span class="line"><span class="comment">//  -------------------------------DataSource end----------------------------</span></span><br><span class="line"><span class="comment">//  -------------------------------Observable creator----------------------------</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SafeObserver</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(destination) &#123;</span><br><span class="line">    <span class="keyword">this</span>.destination = destination;</span><br><span class="line">  &#125;</span><br><span class="line">  next(value) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.isUnsubscribed &amp;&amp; <span class="keyword">this</span>.destination.next) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.destination.next(value);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="keyword">this</span>.unsubscribe();</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  error(err) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.isUnsubscribed &amp;&amp; <span class="keyword">this</span>.destination.error) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.destination.error(err);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e2) &#123;</span><br><span class="line">        <span class="keyword">this</span>.unsubscribe();</span><br><span class="line">        <span class="keyword">throw</span> e2;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.unsubscribe();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  complete() &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.isUnsubscribed &amp;&amp; <span class="keyword">this</span>.destination.complete) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.destination.complete();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="keyword">this</span>.unsubscribe();</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.unsubscribe();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  unsubscribe() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isUnsubscribed = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.unsub) &#123;</span><br><span class="line">      <span class="keyword">this</span>.unsub();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(_subscribe) &#123;</span><br><span class="line">    <span class="keyword">this</span>._subscribe = _subscribe;</span><br><span class="line">  &#125;</span><br><span class="line">  subscribe(observer) &#123;</span><br><span class="line">    <span class="keyword">const</span> safeObserver = <span class="keyword">new</span> SafeObserver(observer);</span><br><span class="line">    safeObserver.unsub = <span class="keyword">this</span>._subscribe(safeObserver);</span><br><span class="line">    <span class="keyword">return</span> safeObserver.unsubscribe.bind(safeObserver);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Observable.from = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    arr.forEach(<span class="function"><span class="params">data</span> =&gt;</span> observer.next(data));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">Observable.fromEvent = <span class="function"><span class="keyword">function</span>(<span class="params">EventDataSource</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> datasource = <span class="keyword">new</span> EventDataSource();</span><br><span class="line">    datasource.ondata = <span class="function"><span class="params">e</span> =&gt;</span> observer.next(e);</span><br><span class="line">    datasource.onerror = <span class="function"><span class="params">err</span> =&gt;</span> observer.error(err);</span><br><span class="line">    datasource.oncomplete = <span class="function"><span class="params">()</span> =&gt;</span> observer.complete();</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> datasource.destroy();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">Observable.fromPromise = <span class="function"><span class="keyword">function</span>(<span class="params">promise</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    promise.then(<span class="function"><span class="params">data</span> =&gt;</span> observer.next(data));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ----------------------------------observable end----------------------------------</span></span><br><span class="line"><span class="comment">// ----------------------------------Operators----------------------------------</span></span><br><span class="line"><span class="comment">// â€œè¿ç®—ç¬¦â€è¿”å›ä¸ªæ–°çš„å¯è§‚å¯Ÿå¯¹è±¡ï¼Œå½“æ‚¨è®¢é˜…å®ƒæ—¶,å®ƒå°†è®¢é˜…è¯¥å¯è§‚å¯Ÿå¯¹è±¡</span></span><br><span class="line">Observable.prototype.map = <span class="function"><span class="keyword">function</span>(<span class="params">project</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observable(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> mapObserver = &#123;</span><br><span class="line">      next: <span class="function"><span class="params">x</span> =&gt;</span> observer.next(project(x)),</span><br><span class="line">      error: <span class="function"><span class="params">err</span> =&gt;</span> observer.error(err),</span><br><span class="line">      complete: <span class="function"><span class="params">()</span> =&gt;</span> observer.complete()</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.subscribe(mapObserver);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ----------------------------------Operators end-------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ----------------------------------usage----------------------------------</span></span><br><span class="line"><span class="keyword">const</span> myObservable = <span class="keyword">new</span> Observable(<span class="function"><span class="params">observer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> datasource = <span class="keyword">new</span> EventDataSource();</span><br><span class="line">  datasource.ondata = <span class="function"><span class="params">e</span> =&gt;</span> observer.next(e);</span><br><span class="line">  datasource.onerror = <span class="function"><span class="params">err</span> =&gt;</span> observer.error(err);</span><br><span class="line">  datasource.oncomplete = <span class="function"><span class="params">()</span> =&gt;</span> observer.complete();</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> datasource.destroy();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> myObservable1 = Observable.fromEvent(EventDataSource);</span><br><span class="line"><span class="keyword">const</span> myObservable2 = Observable.from(ArraySource);</span><br><span class="line"><span class="keyword">const</span> myObservable3 = Observable.fromPromise(PromiseSource);</span><br><span class="line">myObservable.map(<span class="function"><span class="params">x</span> =&gt;</span> x + x).subscribe(&#123;</span><br><span class="line">  next(x) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">myObservable1.subscribe(&#123;</span><br><span class="line">  next(x) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">myObservable2.subscribe(&#123;</span><br><span class="line">  next(x) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">myObservable3.subscribe(&#123;</span><br><span class="line">  next(x) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="RxJSå®ç°ä¸­æ¶‰åŠçš„å‡ ä¸ªæ¦‚å¿µï¼š"><a href="#RxJSå®ç°ä¸­æ¶‰åŠçš„å‡ ä¸ªæ¦‚å¿µï¼š" class="headerlink" title="RxJSå®ç°ä¸­æ¶‰åŠçš„å‡ ä¸ªæ¦‚å¿µï¼š"></a>RxJSå®ç°ä¸­æ¶‰åŠçš„å‡ ä¸ªæ¦‚å¿µï¼š</h3><ol><li>Observable (å¯è§‚å¯Ÿå¯¹è±¡): è¡¨ç¤ºä¸€ä¸ªæ¦‚å¿µï¼Œè¿™ä¸ªæ¦‚å¿µæ˜¯ä¸€ä¸ªå¯è°ƒç”¨çš„æœªæ¥å€¼æˆ–äº‹ä»¶çš„é›†åˆã€‚</li><li>Observer (è§‚å¯Ÿè€…): ä¸€ä¸ªå›è°ƒå‡½æ•°çš„é›†åˆï¼Œå®ƒçŸ¥é“å¦‚ä½•å»ç›‘å¬ç”± Observable æä¾›çš„å€¼ã€‚</li><li>Subscription (è®¢é˜…): è¡¨ç¤º Observable çš„æ‰§è¡Œï¼Œä¸»è¦ç”¨äºå–æ¶ˆ Observable çš„æ‰§è¡Œã€‚</li><li>Operators (æ“ä½œç¬¦): é‡‡ç”¨å‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„çº¯å‡½æ•° (pure function)ï¼Œä½¿ç”¨åƒ mapã€filterã€concatã€flatMap ç­‰è¿™æ ·çš„æ“ä½œç¬¦æ¥å¤„ç†é›†åˆã€‚</li><li>Subject (ä¸»ä½“): ç›¸å½“äº EventEmitterï¼Œå¹¶ä¸”æ˜¯å°†å€¼æˆ–äº‹ä»¶å¤šè·¯æ¨é€ç»™å¤šä¸ª Observer çš„å”¯ä¸€æ–¹å¼ã€‚</li><li>Schedulers (è°ƒåº¦å™¨): ç”¨æ¥æ§åˆ¶å¹¶å‘å¹¶ä¸”æ˜¯ä¸­å¤®é›†æƒçš„è°ƒåº¦å‘˜ï¼Œå…è®¸æˆ‘ä»¬åœ¨å‘ç”Ÿè®¡ç®—æ—¶è¿›è¡Œåè°ƒï¼Œä¾‹å¦‚ setTimeout æˆ– requestAnimationFrame æˆ–å…¶ä»–ã€‚</li></ol><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul><li><a href="https://medium.com/@benlesh/learning-observable-by-building-observable-d5da57405d87" target="_blank" rel="noopener">Learning Observable By Building Observable â€“ Ben Lesh â€“ Medium</a></li><li><a href="http://cn.rx.js.org/manual/overview.html" target="_blank" rel="noopener">RxJSå…¥é—¨</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ç®€å•æ¥è¯´-Observableæ˜¯ä¸€ä¸ªæ¥æ”¶observerå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯ç”¨äºå–æ¶ˆè®¢é˜…æ–¹æ³•çš„æ–¹æ³•&quot;&gt;&lt;a href=&quot;#ç®€å•æ¥è¯´-Observableæ˜¯ä¸€ä¸ªæ¥æ”¶observerå¹¶ä¸”è¿”å›ä¸€ä¸ªå¯ç”¨äºå–æ¶ˆè®¢é˜…æ–¹æ³•çš„æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;
      
    
    </summary>
    
    
      <category term="RxJS observable" scheme="https://annilq.github.io/tags/RxJS-observable/"/>
    
  </entry>
  
  <entry>
    <title>observer patternå°è®°</title>
    <link href="https://annilq.github.io/2017/10/11/observable-pattern/"/>
    <id>https://annilq.github.io/2017/10/11/observable-pattern/</id>
    <published>2017-10-11T13:48:01.000Z</published>
    <updated>2018-05-21T13:01:33.717Z</updated>
    
    <content type="html"><![CDATA[<p>åŸæ–‡<a href="https://addyosmani.com/resources/essentialjsdesignpatterns/book/#observerpatternjavascript" target="_blank" rel="noopener">Learning JavaScript Design Patterns</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Observer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.update = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">11</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Subject</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.observers = <span class="keyword">new</span> ObserverList();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Subject.prototype.addObserver = <span class="function"><span class="keyword">function</span>(<span class="params">observer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.observers.add(observer);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Subject.prototype.removeObserver = <span class="function"><span class="keyword">function</span>(<span class="params">observer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.observers.removeAt(<span class="keyword">this</span>.observers.indexOf(observer, <span class="number">0</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Subject.prototype.notify = <span class="function"><span class="keyword">function</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> observerCount = <span class="keyword">this</span>.observers.count();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; observerCount; i++) &#123;</span><br><span class="line">    <span class="keyword">this</span>.observers.get(i).update(context);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ObserverList</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.observerList = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ObserverList.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.observerList.push(obj);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ObserverList.prototype.count = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.observerList.length;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ObserverList.prototype.get = <span class="function"><span class="keyword">function</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (index &gt; <span class="number">-1</span> &amp;&amp; index &lt; <span class="keyword">this</span>.observerList.length) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.observerList[index];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ObserverList.prototype.indexOf = <span class="function"><span class="keyword">function</span>(<span class="params">obj, startIndex</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i = startIndex;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (i &lt; <span class="keyword">this</span>.observerList.length) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.observerList[i] === obj) &#123;</span><br><span class="line">      <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    i++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ObserverList.prototype.removeAt = <span class="function"><span class="keyword">function</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.observerList.splice(index, <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Subjectobj = <span class="keyword">new</span> Subject();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Concrete Observer</span></span><br><span class="line"><span class="keyword">var</span> observer = <span class="keyword">new</span> Observer();</span><br><span class="line">observer.update = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Subjectobj.addObserver(observer);</span><br><span class="line"></span><br><span class="line">Subjectobj.notify(<span class="string">"notify"</span>);</span><br><span class="line">Subjectobj.notify(<span class="string">"notify~~~~~~~~~~"</span>);</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŸæ–‡&lt;a href=&quot;https://addyosmani.com/resources/essentialjsdesignpatterns/book/#observerpatternjavascript&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Lea
      
    
    </summary>
    
    
      <category term="javascript pattern" scheme="https://annilq.github.io/tags/javascript-pattern/"/>
    
  </entry>
  
  <entry>
    <title>ç®€å•çš„promiseå®ç°</title>
    <link href="https://annilq.github.io/2017/10/11/Promise/"/>
    <id>https://annilq.github.io/2017/10/11/Promise/</id>
    <published>2017-10-11T13:40:01.000Z</published>
    <updated>2018-05-21T13:01:33.708Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://medium.com/gitconnected/understand-javascript-promises-by-building-a-promise-from-scratch-84c0fd855720" target="_blank" rel="noopener">Learn JavaScript Promises by Building a Promise from Scratch</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PromiseSimple</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(executionFunction) &#123;</span><br><span class="line">    <span class="keyword">this</span>.promiseChain = [];</span><br><span class="line">    <span class="keyword">this</span>.handleError = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">this</span>.onResolve = <span class="keyword">this</span>.onResolve.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.onReject = <span class="keyword">this</span>.onReject.bind(<span class="keyword">this</span>);</span><br><span class="line">    executionFunction(<span class="keyword">this</span>.onResolve, <span class="keyword">this</span>.onReject);</span><br><span class="line">  &#125;</span><br><span class="line">  then(onResolve) &#123;</span><br><span class="line">    <span class="keyword">this</span>.promiseChain.push(onResolve);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span>(handleError) &#123;</span><br><span class="line">    <span class="keyword">this</span>.handleError = handleError;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  onResolve(value) &#123;</span><br><span class="line">    <span class="keyword">let</span> storedValue = value;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.promiseChain.forEach(<span class="function"><span class="params">nextFunction</span> =&gt;</span> &#123;</span><br><span class="line">        storedValue = nextFunction(storedValue);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">this</span>.promiseChain = [];</span><br><span class="line">      <span class="keyword">this</span>.onReject(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  onReject(error) &#123;</span><br><span class="line">    <span class="keyword">this</span>.handleError(error);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">fakeApiBackend</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> user = &#123;</span><br><span class="line">      username: <span class="string">"treyhuffine"</span>,</span><br><span class="line">      favoriteNumber: <span class="number">42</span>,</span><br><span class="line">      profile: <span class="string">"https://gitconnected.com/treyhuffine"</span></span><br><span class="line">    &#125;; <span class="comment">// Introduce a randomizer to simulate the // the probability of encountering an error</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Math</span>.random() &gt; <span class="number">0.05</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">data</span>: user, <span class="attr">statusCode</span>: <span class="number">200</span> &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> error = &#123;</span><br><span class="line">        statusCode: <span class="number">404</span>,</span><br><span class="line">        message: <span class="string">"Could not find user"</span>,</span><br><span class="line">        error: <span class="string">"Not Found"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">return</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="keyword">const</span> makeApiCall = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> PromiseSimple(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(</span><br><span class="line">      () =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> apiResponse = <span class="keyword">this</span>.fakeApiBackend();</span><br><span class="line">        <span class="keyword">if</span> (apiResponse.statusCode &gt;= <span class="number">400</span>) &#123;</span><br><span class="line">          reject(apiResponse);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          resolve(apiResponse.data);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="number">5000</span></span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">makeApiCall()</span><br><span class="line">  .then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"In the first.then()"</span>);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`User <span class="subst">$&#123;user.username&#125;</span>'s favorite number is <span class="subst">$&#123;user.favoriteNumber&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"The previous.then() told you the favoriteNumber"</span>);</span><br><span class="line">    <span class="keyword">return</span> user.profile;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">profile</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`The profile URL is <span class="subst">$&#123;profile&#125;</span>`</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"This is the last then()"</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error.message);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://medium.com/gitconnected/understand-javascript-promises-by-building-a-promise-from-scratch-84c0fd855720&quot; target=&quot;_blank&quot; 
      
    
    </summary>
    
    
      <category term="ES6 promise" scheme="https://annilq.github.io/tags/ES6-promise/"/>
    
  </entry>
  
  <entry>
    <title>ES6 iterator generator å°è®°</title>
    <link href="https://annilq.github.io/2017/09/28/generator/"/>
    <id>https://annilq.github.io/2017/09/28/generator/</id>
    <published>2017-09-28T13:10:01.000Z</published>
    <updated>2018-05-21T13:01:33.711Z</updated>
    
    <content type="html"><![CDATA[<ol><li>æ¯ä¸ªè¿­ä»£å™¨å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªnextæ–¹æ³•ï¼Œæ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªå«æœ‰<code>{done,value}</code>å±æ€§çš„å¯¹è±¡</li><li>ç”Ÿæˆå™¨æ˜¯ä¸€ä¸ªè¿”å›è¿­ä»£å™¨å¯¹è±¡çš„å‡½æ•°</li><li>å¯è¿­ä»£å¯¹è±¡å…·æœ‰ä¸€ä¸ªé»˜è®¤è¿­ä»£å™¨ç”¨Symbol.iteratorå‡½æ•°å±æ€§è¡¨ç¤ºï¼Œå¯ä»¥é‡æ–°å®šä¹‰è¯¥å‡½æ•°æ¥æ·»åŠ æˆ–è€…è¦†ç›–é™„å±å¯¹è±¡çš„è¿­ä»£å™¨</li><li>æ•°ç»„ï¼ŒMapï¼ŒSetä¸­å†…ç½®äº†ä¸‰ç§è¿­ä»£å™¨<ol><li>entries()</li><li>values()</li><li>keys()</li></ol></li><li>for-ofå¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡éƒ½ä¼šè°ƒç”¨å¯è¿­ä»£å¯¹è±¡çš„next()æ–¹æ³•å¹¶å°†è¿­ä»£å™¨è¿”å›çš„ç»“æœå¯¹è±¡çš„valueå€¼å­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼ŒæŒ‡å¯¼è¿”å›å¯¹è±¡çš„doneå€¼ä¸ºtrue</li></ol><h3 id="è®¿é—®é»˜è®¤è¿­ä»£å™¨"><a href="#è®¿é—®é»˜è®¤è¿­ä»£å™¨" class="headerlink" title="è®¿é—®é»˜è®¤è¿­ä»£å™¨"></a>è®¿é—®é»˜è®¤è¿­ä»£å™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> iterator=arr[<span class="built_in">Symbol</span>.iterator]()</span><br><span class="line"><span class="built_in">console</span>.log(iterator.next());</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®è¿­ä»£å™¨"><a href="#è®¾ç½®è¿­ä»£å™¨" class="headerlink" title="è®¾ç½®è¿­ä»£å™¨"></a>è®¾ç½®è¿­ä»£å™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> iter = &#123;</span><br><span class="line">  items: [],</span><br><span class="line">  *[<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> <span class="keyword">this</span>.items) &#123;</span><br><span class="line">      <span class="keyword">yield</span> item;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">iter.items.push(<span class="number">1</span>);</span><br><span class="line">iter.items.push(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> iter) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿­ä»£å™¨å¤„ç†å¼‚æ­¥é—®é¢˜"><a href="#è¿­ä»£å™¨å¤„ç†å¼‚æ­¥é—®é¢˜" class="headerlink" title="è¿­ä»£å™¨å¤„ç†å¼‚æ­¥é—®é¢˜"></a>è¿­ä»£å™¨å¤„ç†å¼‚æ­¥é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¤„ç†åŒæ­¥</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runsync</span>(<span class="params">gen</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> iter = gen();</span><br><span class="line">  <span class="keyword">var</span> result = iter.next();</span><br><span class="line">  <span class="keyword">while</span> (!result.done) &#123;</span><br><span class="line">    result = iter.next(result.value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŒæ­¥genarator</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">sync</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> value = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">  value = <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">  value = <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†å¼‚æ­¥promise</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runasygc</span>(<span class="params">gen</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> iter = gen();</span><br><span class="line">  <span class="keyword">var</span> result = iter.next();</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!result.done) &#123;</span><br><span class="line">      result.value.then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        result = iter.next(data);</span><br><span class="line">        step(result);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  step(result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¼‚æ­¥genarator</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">asygc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> value = <span class="keyword">yield</span> timeout(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">  value = <span class="keyword">yield</span> timeout(<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">  value = <span class="keyword">yield</span> timeout(<span class="number">3</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">runsync(sync);</span><br><span class="line">runasygc(sync);</span><br></pre></td></tr></table></figure><p>å‚è€ƒ</p><ol><li>æ·±å…¥ç†è§£ES6 ç¬¬å…«ç« è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨</li><li><a href="http://es6.ruanyifeng.com/#docs/generator-async" target="_blank" rel="noopener">ECMAScript 6 å…¥é—¨ Generator å‡½æ•°çš„å¼‚æ­¥åº”ç”¨</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;æ¯ä¸ªè¿­ä»£å™¨å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªnextæ–¹æ³•ï¼Œæ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªå«æœ‰&lt;code&gt;{done,value}&lt;/code&gt;å±æ€§çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆå™¨æ˜¯ä¸€ä¸ªè¿”å›è¿­ä»£å™¨å¯¹è±¡çš„å‡½æ•°&lt;/li&gt;
&lt;li&gt;å¯è¿­ä»£å¯¹è±¡å…·æœ‰ä¸€ä¸ªé»˜è®¤è¿­ä»£å™¨ç”¨Symbol.iteratorå‡½æ•°
      
    
    </summary>
    
    
      <category term="ES6 generator" scheme="https://annilq.github.io/tags/ES6-generator/"/>
    
  </entry>
  
  <entry>
    <title>å»ºç«‹è‡ªå·±çš„Redux</title>
    <link href="https://annilq.github.io/2017/07/16/build-your-redux/"/>
    <id>https://annilq.github.io/2017/07/16/build-your-redux/</id>
    <published>2017-07-16T00:53:10.000Z</published>
    <updated>2017-07-25T12:00:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>åŸæ–‡:<a href="https://zapier.com/engineering/how-to-build-redux/" target="_blank" rel="noopener">Build Yourself a Redux</a></p><h3 id="å…ˆæ¥çœ‹çœ‹æ²¡æœ‰reduxæˆ‘ä»¬æ€æ ·å»ºç«‹åº”ç”¨"><a href="#å…ˆæ¥çœ‹çœ‹æ²¡æœ‰reduxæˆ‘ä»¬æ€æ ·å»ºç«‹åº”ç”¨" class="headerlink" title="å…ˆæ¥çœ‹çœ‹æ²¡æœ‰reduxæˆ‘ä»¬æ€æ ·å»ºç«‹åº”ç”¨"></a>å…ˆæ¥çœ‹çœ‹æ²¡æœ‰reduxæˆ‘ä»¬æ€æ ·å»ºç«‹åº”ç”¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  nextNoteId: <span class="number">1</span>,</span><br><span class="line">  notes: &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.state = initialState;</span><br><span class="line"><span class="keyword">const</span> onAddNote = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> id = <span class="built_in">window</span>.state.nextNoteId;</span><br><span class="line">  <span class="built_in">window</span>.state.notes[id] = &#123;</span><br><span class="line">    id,</span><br><span class="line">    content: <span class="string">""</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">window</span>.state.nextNoteId++;</span><br><span class="line">  renderApp();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> NoteApp = <span class="function">(<span class="params">&#123; notes &#125;</span>) =&gt;</span> (</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;ul className=<span class="string">"note-list"</span>&gt;</span><br><span class="line">      &#123;<span class="built_in">Object</span>.keys(notes).map(<span class="function"><span class="params">id</span> =&gt;</span> (</span><br><span class="line">        &lt;li className=<span class="string">"note-list-item"</span> key=&#123;id&#125;&gt;&#123;id&#125;&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">      ))&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/u</span>l&gt;</span><br><span class="line">    &lt;button className=<span class="string">"editor-button"</span> onClick=&#123;onAddNote&#125;&gt;New Note&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> renderApp = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  ReactDOM.render(</span><br><span class="line">    &lt;NoteApp notes=&#123;<span class="built_in">window</span>.state.notes&#125; /&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"root"</span>)</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line">renderApp();</span><br></pre></td></tr></table></figure><p><a href="https://jsfiddle.net/justindeal/5j3can1z/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=5j3can1z" target="_blank" rel="noopener">jsfiddle</a></p><h4 id="ä¸Šé¢è¿™ç§æ–¹å¼å¸¦æ¥çš„é—®é¢˜"><a href="#ä¸Šé¢è¿™ç§æ–¹å¼å¸¦æ¥çš„é—®é¢˜" class="headerlink" title="ä¸Šé¢è¿™ç§æ–¹å¼å¸¦æ¥çš„é—®é¢˜"></a>ä¸Šé¢è¿™ç§æ–¹å¼å¸¦æ¥çš„é—®é¢˜</h4><ol><li>ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥æ¸²æŸ“ç»„ä»¶,æ¯æ¬¡stateæ”¹å˜éƒ½è¦è°ƒç”¨renderAppï¼Œä¼šå¯¼è‡´UIçš„æ•…éšœæˆ–è€…æ— å“åº”</li><li>æµç¨‹åˆ¤æ–­æ¡ä»¶å¯èƒ½å®šä¹‰åœ¨è‡ªä¸åŒåœ°æ–¹</li><li>æ— æ³•æµ‹è¯•ä»£ç ï¼Œå¿…é¡»è¦è®°ä½æ•´ä¸ªåº”ç”¨çš„stateæ‰è¡Œ</li><li>å¦‚æœå‡ºbugäº†å¾ˆéš¾å®šä½</li></ol><p>æœ€åé‡è¦çš„ä¸€ç‚¹æ˜¯å¦‚æœä½ æƒ³ç¼©å°ä½ çš„appåŠŸèƒ½ï¼Œä½ å¯èƒ½è¦æ”¹å¾ˆå¤šåœ°æ–¹</p><h3 id="ç°åœ¨å‡†å¤‡å»ºç«‹è‡ªå·±çš„Redux"><a href="#ç°åœ¨å‡†å¤‡å»ºç«‹è‡ªå·±çš„Redux" class="headerlink" title="ç°åœ¨å‡†å¤‡å»ºç«‹è‡ªå·±çš„Redux"></a>ç°åœ¨å‡†å¤‡å»ºç«‹è‡ªå·±çš„Redux</h3><p>redux æ¶‰åŠçš„ä¸‰ä¸ªæ¦‚å¿µ</p><ol><li>reducer</li><li>store(state)</li><li>action</li></ol><h4 id="1-å…ˆçœ‹çœ‹Reducer"><a href="#1-å…ˆçœ‹çœ‹Reducer" class="headerlink" title="1. å…ˆçœ‹çœ‹Reducer"></a>1. å…ˆçœ‹çœ‹Reducer</h4><ol><li>reducerå‡½æ•°æ¥æ”¶ä¸€ä¸ªstateå’Œactionï¼Œè¿”å›ä¸€ä¸ªæ–°çš„state</li><li>reduceræ˜¯ä¸€ä¸ªçº¯å‡½æ•°<br>ä½¿ç”¨reducer<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state = initialState, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> CREATE_NOTE: &#123;</span><br><span class="line">      <span class="comment">// DO NOT MUTATE STATE LIKE THIS!!!</span></span><br><span class="line">      state.notes[state.nextNoteId] = &#123;</span><br><span class="line">        id: state.nextNoteId,</span><br><span class="line">        content: <span class="string">""</span></span><br><span class="line">      &#125;;</span><br><span class="line">      state.nextNoteId++;</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> UPDATE_NOTE: &#123;</span><br><span class="line">      <span class="comment">// DO NOT MUTATE STATE LIKE THIS!!!</span></span><br><span class="line">      state.notes[action.id].content = action.content;</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> state0 = reducer(<span class="literal">undefined</span>, &#123;</span><br><span class="line">  type: CREATE_NOTE</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   nextNoteId: 2,</span></span><br><span class="line"><span class="comment">//   notes: &#123;</span></span><br><span class="line"><span class="comment">//     1: &#123;</span></span><br><span class="line"><span class="comment">//       id: 1,</span></span><br><span class="line"><span class="comment">//       content: ''</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">const</span> state1  = reducer(state0, &#123;</span><br><span class="line">  type: UPDATE_NOTE,</span><br><span class="line">  id: <span class="number">1</span>,</span><br><span class="line">  content: <span class="string">'Hello, world!'</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   nextNoteId: 2,</span></span><br><span class="line"><span class="comment">//   notes: &#123;</span></span><br><span class="line"><span class="comment">//     1: &#123;</span></span><br><span class="line"><span class="comment">//       id: 1,</span></span><br><span class="line"><span class="comment">//       content: 'Hello, world!'</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure></li></ol><p>ä¸Šé¢å°±æ˜¯reduxçš„æ ¸å¿ƒä»£ç ï¼Œä¸€ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªstateå’Œactionï¼Œè¿”å›ä¸€ä¸ªæ–°çš„stateï¼Œè‡³äºä¸ºä»€ä¹ˆè¦å«reducerï¼Œå› ä¸ºä»–å¯ä»¥ç›´æ¥ç”¨äºreduce functionä¸­<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> actions = [</span><br><span class="line">  &#123;<span class="attr">type</span>: CREATE_NOTE&#125;,</span><br><span class="line">  &#123;<span class="attr">type</span>: UPDATE_NOTE, <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">content</span>: <span class="string">'Hello, world!'</span>&#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> state = actions.reduce(reducer, <span class="literal">undefined</span>);</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   nextNoteId: 2,</span></span><br><span class="line"><span class="comment">//   notes: &#123;</span></span><br><span class="line"><span class="comment">//     1: &#123;</span></span><br><span class="line"><span class="comment">//       id: 1,</span></span><br><span class="line"><span class="comment">//       content: 'Hello, world!'</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure></p><h4 id="2-å†æ¥çœ‹çœ‹store"><a href="#2-å†æ¥çœ‹çœ‹store" class="headerlink" title="2. å†æ¥çœ‹çœ‹store"></a>2. å†æ¥çœ‹çœ‹store</h4><p>store ä¼šä¿å­˜æˆ‘ä»¬çš„stateå¹¶ä¸”è¿˜æœ‰ä¸€äº›è®¾ç½®å’Œè·å–stateçš„æ–¹æ³•<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateAction = <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!action || <span class="keyword">typeof</span> action !== <span class="string">'object'</span> || <span class="built_in">Array</span>.isArray(action)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Action must be an object!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> action.type === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Action must have a type!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createStore = <span class="function">(<span class="params">reducer</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> state = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    dispatch: <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">      validateAction(action)</span><br><span class="line">      state = reducer(state, action);</span><br><span class="line">    &#125;,</span><br><span class="line">    getState: <span class="function"><span class="params">()</span> =&gt;</span> state</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸‹store<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Pass in the reducer we made earlier.</span></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer);</span><br><span class="line">store.dispatch(&#123;</span><br><span class="line">  type: CREATE_NOTE</span><br><span class="line">&#125;);</span><br><span class="line">store.getState();</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   nextNoteId: 2,</span></span><br><span class="line"><span class="comment">//   notes: &#123;</span></span><br><span class="line"><span class="comment">//     1: &#123;</span></span><br><span class="line"><span class="comment">//       id: 1,</span></span><br><span class="line"><span class="comment">//       content: ''</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure></p><p>å®ƒä»ç„¶ç¼ºå°‘ä¸€ä¸ªé‡è¦çš„ä¸€ç‚¹ï¼šä¸€ç§è®¢é˜…æ›´æ”¹çš„æ–¹æ³•ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createStore = <span class="function"><span class="params">reducer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> state;</span><br><span class="line">  <span class="keyword">const</span> subscribers = [];</span><br><span class="line">  <span class="keyword">const</span> store = &#123;</span><br><span class="line">    dispatch: <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">      validateAction(action);</span><br><span class="line">      state = reducer(state, action);</span><br><span class="line">      subscribers.forEach(<span class="function"><span class="params">handler</span> =&gt;</span> handler());</span><br><span class="line">    &#125;,</span><br><span class="line">    getState: <span class="function"><span class="params">()</span> =&gt;</span> state,</span><br><span class="line">    subscribe: <span class="function"><span class="params">handler</span> =&gt;</span> &#123;</span><br><span class="line">      subscribers.push(handler);</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// for unsubcribe</span></span><br><span class="line">        <span class="keyword">const</span> index = subscribers.indexOf(handler);</span><br><span class="line">        <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          subscribers.splice(index, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  store.dispatch(&#123;<span class="attr">type</span>: <span class="string">'@@redux/INIT'</span>&#125;);</span><br><span class="line">  <span class="keyword">return</span> store;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p><a href="https://jsfiddle.net/justindeal/8cpu4ydj/3/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=8cpu4ydj" target="_blank" rel="noopener">jsfiddle demo</a></p><h4 id="3-å›æƒ³ä¸‹ä½ æ˜¯æ€æ ·ç”¨reduxçš„ï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·å§"><a href="#3-å›æƒ³ä¸‹ä½ æ˜¯æ€æ ·ç”¨reduxçš„ï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·å§" class="headerlink" title="3. å›æƒ³ä¸‹ä½ æ˜¯æ€æ ·ç”¨reduxçš„ï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·å§"></a>3. å›æƒ³ä¸‹ä½ æ˜¯æ€æ ·ç”¨reduxçš„ï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·å§</h4><ol><li>é¦–å…ˆå®šä¹‰ä¸€ä¸ªpure component</li><li>ç„¶åä¸ºä»–å†åŒ…è£…ä¸€ä¸ªcontainer<br>æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„reduxæ˜¯å°†storeä¼ åˆ°containerä¸­ï¼Œå†å°†æ–¹æ³•ä¼ é€’ä¸‹å»</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateAction = <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!action || <span class="keyword">typeof</span> action !== <span class="string">'object'</span> || <span class="built_in">Array</span>.isArray(action)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Action must be an object!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> action.type === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Action must have a type!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createStore = <span class="function"><span class="params">reducer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> state;</span><br><span class="line">  <span class="keyword">const</span> subscribers = [];</span><br><span class="line">  <span class="keyword">const</span> store = &#123;</span><br><span class="line">    dispatch: <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">      validateAction(action);</span><br><span class="line">      state = reducer(state, action);</span><br><span class="line">      subscribers.forEach(<span class="function"><span class="params">handler</span> =&gt;</span> handler());</span><br><span class="line">    &#125;,</span><br><span class="line">    getState: <span class="function"><span class="params">()</span> =&gt;</span> state,</span><br><span class="line">    subscribe: <span class="function"><span class="params">handler</span> =&gt;</span> &#123;</span><br><span class="line">      subscribers.push(handler);</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> index = subscribers.indexOf(handler);</span><br><span class="line">        <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          subscribers.splice(index, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  store.dispatch(&#123;<span class="attr">type</span>: <span class="string">'@@redux/INIT'</span>&#125;);</span><br><span class="line">  <span class="keyword">return</span> store;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//////////////////////</span></span><br><span class="line"><span class="comment">// Our action types //</span></span><br><span class="line"><span class="comment">//////////////////////</span></span><br><span class="line"><span class="keyword">const</span> CREATE_NOTE = <span class="string">'CREATE_NOTE'</span>;</span><br><span class="line"><span class="keyword">const</span> UPDATE_NOTE = <span class="string">'UPDATE_NOTE'</span>;</span><br><span class="line"><span class="keyword">const</span> OPEN_NOTE = <span class="string">'OPEN_NOTE'</span>;</span><br><span class="line"><span class="keyword">const</span> CLOSE_NOTE = <span class="string">'CLOSE_NOTE'</span>;</span><br><span class="line"><span class="comment">/////////////////</span></span><br><span class="line"><span class="comment">// Our reducer //</span></span><br><span class="line"><span class="comment">/////////////////</span></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  nextNoteId: <span class="number">1</span>,</span><br><span class="line">  notes: &#123;&#125;,</span><br><span class="line">  openNoteId: <span class="literal">null</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state = initialState, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> CREATE_NOTE: &#123;</span><br><span class="line">      <span class="keyword">const</span> id = state.nextNoteId;</span><br><span class="line">      <span class="keyword">const</span> newNote = &#123;</span><br><span class="line">        id,</span><br><span class="line">        content: <span class="string">''</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        nextNoteId: id + <span class="number">1</span>,</span><br><span class="line">        openNoteId: id,</span><br><span class="line">        notes: &#123;</span><br><span class="line">          ...state.notes,</span><br><span class="line">          [id]: newNote</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> UPDATE_NOTE: &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123;id, content&#125; = action;</span><br><span class="line">      <span class="keyword">const</span> editedNote = &#123;</span><br><span class="line">        ...state.notes[id],</span><br><span class="line">        content</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        notes: &#123;</span><br><span class="line">          ...state.notes,</span><br><span class="line">          [id]: editedNote</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> OPEN_NOTE: &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        openNoteId: action.id</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> CLOSE_NOTE: &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        openNoteId: <span class="literal">null</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">///////////////</span></span><br><span class="line"><span class="comment">// Our store //</span></span><br><span class="line"><span class="comment">///////////////</span></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer);</span><br><span class="line"><span class="comment">////////////////////</span></span><br><span class="line"><span class="comment">// Our components //</span></span><br><span class="line"><span class="comment">////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NoteEditor = <span class="function">(<span class="params">&#123;note, onChangeNote, onCloseNote&#125;</span>) =&gt;</span> (</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;textarea</span><br><span class="line">        className=<span class="string">"editor-content"</span></span><br><span class="line">        autoFocus</span><br><span class="line">        value=&#123;note.content&#125;</span><br><span class="line">        onChange=&#123;event =&gt;</span><br><span class="line">          onChangeNote(note.id, event.target.value)</span><br><span class="line">        &#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button className="editor-button" onClick=&#123;onCloseNote&#125;&gt;</span></span><br><span class="line"><span class="regexp">      Close</span></span><br><span class="line"><span class="regexp">    &lt;/</span>button&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp">const NoteTitle = (&#123;note&#125;) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  const title = note.content</span></span><br><span class="line"><span class="regexp">    .split('\n')[0].replace(/</span>^\s+|\s+$/g, <span class="string">''</span>);</span><br><span class="line">  <span class="keyword">if</span> (title === <span class="string">''</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">i</span>&gt;</span>Untitled<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> NoteLink = <span class="function">(<span class="params">&#123;note, onOpenNote&#125;</span>) =&gt;</span> (</span><br><span class="line">  &lt;li className=<span class="string">"note-list-item"</span>&gt;</span><br><span class="line">    &lt;a href=<span class="string">"#"</span> onClick=&#123;() =&gt; onOpenNote(note.id)&#125;&gt;</span><br><span class="line">      &lt;NoteTitle note=&#123;note&#125;/&gt;</span><br><span class="line">    &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>li&gt;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> NoteList = <span class="function">(<span class="params">&#123;notes, onOpenNote&#125;</span>) =&gt;</span> (</span><br><span class="line">  &lt;ul className=<span class="string">"note-list"</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">Object</span>.keys(notes).map(<span class="function"><span class="params">id</span> =&gt;</span></span><br><span class="line">        &lt;NoteLink</span><br><span class="line">          key=&#123;id&#125;</span><br><span class="line">          note=&#123;notes[id]&#125;</span><br><span class="line">          onOpenNote=&#123;onOpenNote&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp">const NoteApp = (&#123;</span></span><br><span class="line"><span class="regexp">  notes, openNoteId, onAddNote, onChangeNote,</span></span><br><span class="line"><span class="regexp">  onOpenNote, onCloseNote</span></span><br><span class="line"><span class="regexp">&#125;) =&gt; (</span></span><br><span class="line"><span class="regexp">  &lt;div&gt;</span></span><br><span class="line"><span class="regexp">    &#123;</span></span><br><span class="line"><span class="regexp">      openNoteId ?</span></span><br><span class="line"><span class="regexp">        &lt;NoteEditor</span></span><br><span class="line"><span class="regexp">          note=&#123;notes[openNoteId]&#125;</span></span><br><span class="line"><span class="regexp">          onChangeNote=&#123;onChangeNote&#125;</span></span><br><span class="line"><span class="regexp">          onCloseNote=&#123;onCloseNote&#125;</span></span><br><span class="line"><span class="regexp">        /</span>&gt; :</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;NoteList</span><br><span class="line">            notes=&#123;notes&#125;</span><br><span class="line">            onOpenNote=&#123;onOpenNote&#125;</span><br><span class="line">          /&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            &lt;button</span><br><span class="line">              className=<span class="string">"editor-button"</span></span><br><span class="line">              onClick=&#123;onAddNote&#125;</span><br><span class="line">            &gt;</span><br><span class="line">              New Note</span><br><span class="line">            &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">          &#125;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp">class NoteAppContainer extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  constructor(props) &#123;</span></span><br><span class="line"><span class="regexp">    super();</span></span><br><span class="line"><span class="regexp">    this.state = props.store.getState();</span></span><br><span class="line"><span class="regexp">    this.onAddNote = this.onAddNote.bind(this);</span></span><br><span class="line"><span class="regexp">    this.onChangeNote = this.onChangeNote.bind(this);</span></span><br><span class="line"><span class="regexp">    this.onOpenNote = this.onOpenNote.bind(this);</span></span><br><span class="line"><span class="regexp">    this.onCloseNote = this.onCloseNote.bind(this);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  componentWillMount() &#123;</span></span><br><span class="line"><span class="regexp">    this.unsubscribe = this.props.store.subscribe(() =&gt;</span></span><br><span class="line"><span class="regexp">      this.setState(this.props.store.getState())</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  componentWillUnmount() &#123;</span></span><br><span class="line"><span class="regexp">    this.unsubscribe();</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  onAddNote() &#123;</span></span><br><span class="line"><span class="regexp">    this.props.store.dispatch(&#123;</span></span><br><span class="line"><span class="regexp">      type: CREATE_NOTE</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  onChangeNote(id, content) &#123;</span></span><br><span class="line"><span class="regexp">    this.props.store.dispatch(&#123;</span></span><br><span class="line"><span class="regexp">      type: UPDATE_NOTE,</span></span><br><span class="line"><span class="regexp">      id,</span></span><br><span class="line"><span class="regexp">      content</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  onOpenNote(id) &#123;</span></span><br><span class="line"><span class="regexp">    this.props.store.dispatch(&#123;</span></span><br><span class="line"><span class="regexp">      type: OPEN_NOTE,</span></span><br><span class="line"><span class="regexp">      id</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  onCloseNote() &#123;</span></span><br><span class="line"><span class="regexp">    this.props.store.dispatch(&#123;</span></span><br><span class="line"><span class="regexp">      type: CLOSE_NOTE</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;NoteApp</span></span><br><span class="line"><span class="regexp">        &#123;...this.state&#125;</span></span><br><span class="line"><span class="regexp">        onAddNote=&#123;this.onAddNote&#125;</span></span><br><span class="line"><span class="regexp">        onChangeNote=&#123;this.onChangeNote&#125;</span></span><br><span class="line"><span class="regexp">        onOpenNote=&#123;this.onOpenNote&#125;</span></span><br><span class="line"><span class="regexp">        onCloseNote=&#123;this.onCloseNote&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;NoteAppContainer store=&#123;store&#125;/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ol><li>å°†storeä¸componentè¿æ¥èµ·æ¥</li><li>containeré‡Œé¢åšäº†å¾ˆå¤šé‡å¤çš„å·¥ä½œï¼ˆsubscribe,unsubscribe,function binding)</li><li>æ¯æ¬¡éƒ½ä¼šç”¨åˆ°å…¨å±€çš„storeéƒ½è¦ä¼ é€’</li></ol><h4 id="ç°åœ¨æˆ‘ä»¬è¯•è¯•å®ç°ä¸€ä¸ªreduxçš„provider"><a href="#ç°åœ¨æˆ‘ä»¬è¯•è¯•å®ç°ä¸€ä¸ªreduxçš„provider" class="headerlink" title="ç°åœ¨æˆ‘ä»¬è¯•è¯•å®ç°ä¸€ä¸ªreduxçš„provider"></a>ç°åœ¨æˆ‘ä»¬è¯•è¯•å®ç°ä¸€ä¸ªreduxçš„provider</h4><p>Providerç»„ä»¶ä½¿ç”¨Reactçš„ä¸Šä¸‹æ–‡åŠŸèƒ½å°†storepropè½¬æ¢ä¸ºcontextå±æ€§</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Provider</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  getChildContext() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      store: <span class="keyword">this</span>.props.store</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Provider.childContextTypes = &#123;</span><br><span class="line">  store: PropTypes.object</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æœ‰äº†storeï¼Œä¸‹é¢ç”¨connectå‡½æ•°æˆ‘ä»¬æŠŠcontextä¸Šé¢çš„propsä¼ é€’åˆ°ç»„ä»¶ä¸­<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> connect = (</span><br><span class="line">  mapStateToProps = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;&#125;),</span><br><span class="line">  mapDispatchToProps = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;&#125;)</span><br><span class="line">) =&gt; <span class="function"><span class="params">Component</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Connected</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    onStoreOrPropsChange(props) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">      <span class="keyword">const</span> state = store.getState();</span><br><span class="line">      <span class="keyword">const</span> stateProps = mapStateToProps(state, props);</span><br><span class="line">      <span class="keyword">const</span> dispatchProps = mapDispatchToProps(store.dispatch, props);</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">        ...stateProps,</span><br><span class="line">        ...dispatchProps</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillMount() &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">      <span class="keyword">this</span>.onStoreOrPropsChange(<span class="keyword">this</span>.props);</span><br><span class="line">      <span class="keyword">this</span>.unsubscribe = store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.onStoreOrPropsChange(<span class="keyword">this</span>.props));</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">      <span class="keyword">this</span>.onStoreOrPropsChange(nextProps);</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">      <span class="keyword">this</span>.unsubscribe();</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...this.props</span>&#125; &#123;<span class="attr">...this.state</span>&#125;/&gt;</span>;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">  Connected.contextTypes = &#123;</span></span><br><span class="line"><span class="xml">    store: PropTypes.object</span></span><br><span class="line"><span class="xml">  &#125;;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">  return Connected;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure></p><ol><li>connectå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°mapStateToPropsï¼ŒmapDispatchToPropsï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°</li><li>æ–°çš„å‡½æ•°ä½¿ç”¨å¸¦åŒ…è£…çš„å­ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå°†å­ç»„ä»¶éœ€è¦çš„stateä»¥åŠdispatchï¼Œä½œä¸ºå½“å‰ç»„ä»¶çš„state</li><li>å°†å½“å‰ç»„ä»¶çš„stateä½œä¸ºpropsä¼ é€’ç»™éœ€è¦åŒ…è£…çš„å­ç»„ä»¶</li></ol><p><a href="https://jsfiddle.net/justindeal/o27j5zs1/1/?utm_source=website&amp;utm_medium=embed&amp;utm_campaign=o27j5zs1" target="_blank" rel="noopener">fiddle demo</a></p><h4 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h4><p>ç›®å‰æˆ‘ä»¬çš„reduxè¿˜ä¸èƒ½åº”ä»˜å¼‚æ­¥actionçš„é—®é¢˜ï¼Œåˆ©ç”¨ä¸­é—´ä»¶å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŠ è½½å•ä¸ªä¸­é—´ä»¶çš„ä»£ç å¦‚ä¸‹æ‰€ç¤º<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createStore = <span class="function">(<span class="params">reducer, middleware</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> state;</span><br><span class="line">  <span class="keyword">const</span> subscribers = [];</span><br><span class="line">  <span class="keyword">const</span> coreDispatch = <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">    validateAction(action);</span><br><span class="line">    state = reducer(state, action);</span><br><span class="line">    subscribers.forEach(<span class="function"><span class="params">handler</span> =&gt;</span> handler());</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> getState = <span class="function"><span class="params">()</span> =&gt;</span> state;</span><br><span class="line">  <span class="keyword">const</span> store = &#123;</span><br><span class="line">    dispatch: coreDispatch,</span><br><span class="line">    getState,</span><br><span class="line">    subscribe: <span class="function"><span class="params">handler</span> =&gt;</span> &#123;</span><br><span class="line">      subscribers.push(handler);</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> index = subscribers.indexOf(handler)</span><br><span class="line">        <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          subscribers.splice(index, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="comment">// åˆ¤æ–­æ—¶å€™æœ‰ä¸­é—´ä»¶</span></span><br><span class="line">  <span class="keyword">if</span> (middleware) &#123;</span><br><span class="line">    <span class="keyword">const</span> dispatch = <span class="function"><span class="params">action</span> =&gt;</span> store.dispatch(action);</span><br><span class="line"><span class="comment">// å®é™…æ‰§è¡Œé¡ºåºæ˜¯å½“store.dispatch è¢«è°ƒç”¨çš„æ—¶å€™å…ˆæ‰§è¡Œä¸­é—´ä»¶é‡Œé¢çš„å†…å®¹ï¼Œæ‰§è¡Œä¹‹åå†dispatch action</span></span><br><span class="line">    store.dispatch = middleware(&#123;</span><br><span class="line">      dispatch,</span><br><span class="line">      getState</span><br><span class="line">    &#125;)(coreDispatch);</span><br><span class="line">  &#125;</span><br><span class="line">  coreDispatch(&#123;<span class="attr">type</span>: <span class="string">'@@redux/INIT'</span>&#125;);</span><br><span class="line">  <span class="keyword">return</span> store;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>thunkMiddleware<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> thunkMiddleware = <span class="function">(<span class="params">&#123;dispatch, getState&#125;</span>) =&gt;</span> next =&gt; <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> action === <span class="string">'function'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> action(&#123;dispatch, getState&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> next(action);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>ps:ä¸Šé¢å…³äºä¸­é—´ä»¶ä»£ç ä¸æ˜¯å¾ˆå¥½ç†è§£å¯ä»¥å‚è€ƒ<br><a href="https://zhuanlan.zhihu.com/p/21391101" target="_blank" rel="noopener">ç†è§£ redux ä¸­é—´ä»¶</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŸæ–‡:&lt;a href=&quot;https://zapier.com/engineering/how-to-build-redux/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Build Yourself a Redux&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;å…ˆæ¥çœ‹
      
    
    </summary>
    
    
      <category term="Redux" scheme="https://annilq.github.io/tags/Redux/"/>
    
  </entry>
  
  <entry>
    <title>ES6 asyncï¼await å°è®°</title>
    <link href="https://annilq.github.io/2017/07/02/async/"/>
    <id>https://annilq.github.io/2017/07/02/async/</id>
    <published>2017-07-02T13:48:01.000Z</published>
    <updated>2018-02-01T12:50:05.000Z</updated>
    
    <content type="html"><![CDATA[<p>async await åŸºäºpromise</p><ol><li>async function åˆ›å»ºä¹‹åç«‹å³è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡</li><li>await å…³é”®å­—åªèƒ½åœ¨async function ä¸­ï¼Œåé¢è·Ÿç€çš„æ“ä½œçš„è¿”å›å€¼å¯ä»¥æ˜¯promiseå¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯åŸå§‹å€¼,å¦‚æœäº‹åŸå§‹å€¼ç­‰äºäº‹åŒæ­¥æ“ä½œ</li><li>async function returnçš„å€¼ç­‰äºasync functionè¿”å›çš„promiseå¯¹è±¡resolveçš„å€¼</li><li>äº’ç›¸ä¸ä¾èµ–çš„async functionå¯ä»¥ç”¨promise.allæ¥å°†æ‰€æœ‰çš„æ“ä½œä¸€èµ·await<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŒæ­¥æ“ä½œ</span></span><br><span class="line"><span class="keyword">var</span> sleep = <span class="function"><span class="keyword">function</span>(<span class="params">para</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> para + <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// å¼‚æ­¥æ“ä½œ</span></span><br><span class="line"><span class="keyword">var</span> sleep2 = <span class="function"><span class="keyword">function</span>(<span class="params">para</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(</span><br><span class="line">      <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        resolve(para * para);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="number">2000</span></span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// äº’ç›¸ä¾èµ–</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">asyncSleep</span>(<span class="params">para</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result1 = <span class="keyword">await</span> sleep(para);</span><br><span class="line">  <span class="keyword">var</span> result2 = <span class="keyword">await</span> sleep2(result1);</span><br><span class="line">  <span class="keyword">var</span> result3 = <span class="keyword">await</span> sleep2(result2);</span><br><span class="line">  <span class="keyword">return</span> result3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// äº’ç›¸ä¸ä¾èµ–çš„function</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">asyncSleep2</span>(<span class="params">para</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result1 = <span class="keyword">await</span> sleep(para);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.all([sleep2(result1), sleep2(<span class="number">2</span>)]);</span><br><span class="line">&#125;</span><br><span class="line">asyncSleep(<span class="number">2</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">result2</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//result2 is 256</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"asyncSleep"</span>, result2);</span><br><span class="line">&#125;);</span><br><span class="line">asyncSleep2(<span class="number">2</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">[result, result2]</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//16 4</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"asyncSleep2"</span>, result, result2);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><p>å‚è€ƒé“¾æ¥<br><a href="http://es6.ruanyifeng.com/#docs/async" target="_blank" rel="noopener">ECMAScript 6 å…¥é—¨ async å‡½æ•°</a><br><a href="https://hackernoon.com/6-reasons-why-javascripts-async-await-blows-promises-away-tutorial-c7ec10518dd9" target="_blank" rel="noopener">6 Reasons Why JavaScriptâ€™s Async/Await Blows Promises Away</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;async await åŸºäºpromise&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;async function åˆ›å»ºä¹‹åç«‹å³è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡&lt;/li&gt;
&lt;li&gt;await å…³é”®å­—åªèƒ½åœ¨async function ä¸­ï¼Œåé¢è·Ÿç€çš„æ“ä½œçš„è¿”å›å€¼å¯ä»¥æ˜¯promiseå¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯åŸå§‹
      
    
    </summary>
    
    
      <category term="async await promise" scheme="https://annilq.github.io/tags/async-await-promise/"/>
    
  </entry>
  
  <entry>
    <title>nodejså°è®°</title>
    <link href="https://annilq.github.io/2017/04/09/nodejs/"/>
    <id>https://annilq.github.io/2017/04/09/nodejs/</id>
    <published>2017-04-09T15:05:01.000Z</published>
    <updated>2017-11-29T12:34:25.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„æ¡ˆä¾‹"><a href="#ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„æ¡ˆä¾‹" class="headerlink" title="ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„æ¡ˆä¾‹"></a>ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„æ¡ˆä¾‹</h3><p>server.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line">http</span><br><span class="line">  .createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.method == <span class="string">"POST"</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"POST"</span>);</span><br><span class="line">      <span class="keyword">var</span> body = <span class="string">""</span>;</span><br><span class="line">      req.on(<span class="string">"data"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        body += data;</span><br><span class="line">        <span class="built_in">console</span>.log(body);</span><br><span class="line">      &#125;);</span><br><span class="line">      req.on(<span class="string">"end"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Body: "</span> + body);</span><br><span class="line">        res.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">        res.end(body);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"GET"</span>);</span><br><span class="line">      res.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">      res.end(<span class="string">"get"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .listen(<span class="number">3000</span>, <span class="string">"127.0.0.1"</span>);</span><br></pre></td></tr></table></figure></p><p>client.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">"querystring"</span>);</span><br><span class="line"><span class="keyword">var</span> data = &#123; <span class="attr">name</span>: <span class="string">"annilq"</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">  hostname: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">  port: <span class="number">3000</span>,</span><br><span class="line">  method: <span class="string">"POST"</span>,</span><br><span class="line">  path: <span class="string">"/"</span>,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    <span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>,</span><br><span class="line">    <span class="string">"Content-Length"</span>: Buffer.byteLength(querystring.stringify(data))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> req = http.request(options, <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"statusCode"</span>, res.statusCode);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"header"</span>, <span class="built_in">JSON</span>.stringify(res.headers));</span><br><span class="line">  <span class="keyword">var</span> body = <span class="string">""</span>;</span><br><span class="line">  res.setEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">  res.on(<span class="string">"data"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    body += data;</span><br><span class="line">  &#125;);</span><br><span class="line">  res.on(<span class="string">"end"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(body);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">req.end(querystring.stringify(data));</span><br></pre></td></tr></table></figure></p><h3 id="æ–¹æ³•è¯´æ˜"><a href="#æ–¹æ³•è¯´æ˜" class="headerlink" title="æ–¹æ³•è¯´æ˜"></a>æ–¹æ³•è¯´æ˜</h3><ol><li><p>Buffer.byteLengthæ–¹æ³•è¿”å›å­—ç¬¦ä¸²å®é™…å æ®çš„å­—èŠ‚é•¿åº¦ï¼Œé»˜è®¤ç¼–ç æ–¹å¼ä¸ºutf8ã€‚</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">Buffer</span><span class="selector-class">.byteLength</span>(<span class="string">'Hello'</span>, <span class="string">'utf8'</span>) <span class="comment">// 5</span></span><br></pre></td></tr></table></figure></li><li><p>å¯¹è±¡æ ¼å¼åŒ–æˆå‚æ•°å­—ç¬¦ä¸² ,objå°±æ˜¯è¦æ ¼å¼åŒ–çš„å¯¹è±¡,å¿…é€‰å‚æ•°. [sep]æŒ‡åˆ†éš”ç¬¦ é»˜è®¤&amp; , [eq]æŒ‡åˆ†é…ç¬¦ é»˜è®¤=</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">querystring.stringify(obj, [sep], [eq])</span><br><span class="line">querystring.stringify(&#123; <span class="string">foo:</span> <span class="string">'bar'</span>, <span class="string">baz:</span> [<span class="string">'qux'</span>, <span class="string">'quux'</span>], <span class="string">corge:</span> <span class="string">''</span> &#125;)</span><br><span class="line"><span class="comment">// returns 'foo=bar&amp;baz=qux&amp;baz=quux&amp;corge='</span></span><br><span class="line">querystring.stringify(&#123;<span class="string">foo:</span> <span class="string">'bar'</span>, <span class="string">baz:</span> <span class="string">'qux'</span>&#125;, <span class="string">';'</span>, <span class="string">':'</span>)</span><br><span class="line"><span class="comment">// returns 'foo:bar;baz:qux'</span></span><br></pre></td></tr></table></figure></li></ol><p>éœ€è¦æ³¨æ„çš„é—®é¢˜</p><ol><li>server reqåªæœ‰åœ¨ client req post æ•°æ®æ—¶å€™æ‰èƒ½ç›‘å¬åˆ°â€dataâ€ äº‹ä»¶</li><li>client headersæŒ‡å®šäº†é”™è¯¯çš„ content-lengthæ—¶å€™ï¼Œserverçš„reqçš„endäº‹ä»¶ä¸ä¼šè§¦å‘<blockquote><p><a href="https://github.com/nodejs/node-v0.x-archive/issues/4200" target="_blank" rel="noopener">request â€˜endâ€™ event not called if content-length is incorrect</a></p></blockquote></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„æ¡ˆä¾‹&quot;&gt;&lt;a href=&quot;#ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„æ¡ˆä¾‹&quot; class=&quot;headerlink&quot; title=&quot;ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„æ¡ˆä¾‹&quot;&gt;&lt;/a&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æœåŠ¡å™¨å“åº”è¯·æ±‚çš„
      
    
    </summary>
    
    
      <category term="nodejs" scheme="https://annilq.github.io/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title>jsä¸åŸç”Ÿäº¤äº’</title>
    <link href="https://annilq.github.io/2017/03/27/native/"/>
    <id>https://annilq.github.io/2017/03/27/native/</id>
    <published>2017-03-27T12:50:01.000Z</published>
    <updated>2017-03-27T13:09:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¬å¸åŸæ¥çš„é¡¹ç›®æ˜¯ç”¨cordovaå‘½ä»¤è¡Œåˆ›å»ºçš„ï¼Œé¡µé¢UIå…¨æ˜¯webæŠ€æœ¯ç”»çš„ï¼Œç›®å‰é¡¹ç›®ä¼˜åŒ–å°†é¦–é¡µä»¥åŠåˆ—è¡¨é¡µé¢ç”¨åŸç”Ÿé‡å†™äº†ï¼Œä¹Ÿå¼ƒç”¨äº†ä¹‹å‰çš„cordovaæ¶æ„ï¼Œä½†æ˜¯ç”±äºä¹‹å‰é¡µé¢ä¹Ÿéœ€è¦åˆ°ä¸åŸç”Ÿäº¤äº’ï¼Œæˆ‘å°±è‡ªå·±ç®€å•å†™äº†ä¸ªæ–¹æ³•ç”¨æ¥ä¸åŸç”Ÿäº¤äº’<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> NativeUtil = &#123;</span><br><span class="line">  _Callback: &#123;&#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * [è°ƒç”¨åŸç”Ÿæ–¹æ³•]</span></span><br><span class="line"><span class="comment">   * @param  &#123;[type]&#125;   name     [åŸç”Ÿæ–¹æ³•å]</span></span><br><span class="line"><span class="comment">   * @param  &#123;Function&#125; callback [æˆåŠŸä¹‹åçš„å›è°ƒ]</span></span><br><span class="line"><span class="comment">   * @param  &#123;[type]&#125;   param    [åŸç”Ÿæ’ä»¶éœ€è¦çš„å‚æ•°]</span></span><br><span class="line"><span class="comment">   * @return [type]              æ’ä»¶è¿”å›å€¼</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  use: <span class="function"><span class="keyword">function</span>(<span class="params">name, callback, param</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(args);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>[name]) &#123;</span><br><span class="line">      <span class="keyword">if</span> (args.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> callbackId = <span class="keyword">this</span>._genetateId(name);</span><br><span class="line">        <span class="keyword">this</span>._Callback[callbackId] = callback;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (args.length &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>[name](callbackId, param);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (args.length == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>[name](callbackId);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (args.length == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>[name]();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   *  ç”Ÿæˆå›è°ƒid</span></span><br><span class="line"><span class="comment">   * @param  &#123;[type]&#125; name [è°ƒç”¨çš„åŸç”Ÿæ–¹æ³•å]</span></span><br><span class="line"><span class="comment">   * @return [type]        [å›è°ƒid]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  _genetateId: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> callbackId;</span><br><span class="line">    callbackId = name + <span class="string">"CB"</span> + (<span class="string">""</span> + <span class="built_in">Date</span>.now()).slice(<span class="number">-7</span>);</span><br><span class="line">    <span class="keyword">return</span> callbackId;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç”¨äºåŸç”Ÿå›è°ƒçš„å¤„ç†æ–¹æ³•</span></span><br><span class="line"><span class="comment">   * @param  &#123;[type]&#125; callbackId [æ¯ä¸€ä¸ªå›è°ƒä¼šæœ‰è‡ªå·±id]</span></span><br><span class="line"><span class="comment">   * @param  &#123;[type]&#125; result     [åŸç”Ÿè¿”å›çš„ç»“æœ]</span></span><br><span class="line"><span class="comment">   * @return [type]              [description]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  NativeCallback: <span class="function"><span class="keyword">function</span>(<span class="params">callbackId, result</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._Callback[callbackId]) &#123;</span><br><span class="line">      <span class="keyword">this</span>._Callback[callbackId](result);</span><br><span class="line">      <span class="keyword">delete</span> <span class="keyword">this</span>._Callback[callbackId];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.info(<span class="string">"NativeCallback can't found callbackId"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * é€‰æ‹©ä¸ä¸Šä¼ å›¾ç‰‡</span></span><br><span class="line"><span class="comment">   * @param  &#123;[type]&#125; callbackId [ç”¨äºå›è°ƒ]</span></span><br><span class="line"><span class="comment">   * @param  &#123;[type]&#125; num        [å¯ä»¥é€‰å‡ å¼ ]</span></span><br><span class="line"><span class="comment">   * @return [type]              [description]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  choosePhoto:<span class="function"><span class="keyword">function</span>(<span class="params">callbackId,num</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.jsInterface) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">window</span>.jsInterface.choosePhoto(callbackId,num);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è·å–å½“å‰åº”ç”¨ç‰ˆæœ¬å·</span></span><br><span class="line"><span class="comment">   * @return [type] [description]</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  getAppVersion: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.jsInterface) &#123;</span><br><span class="line">      <span class="keyword">var</span> appversion = <span class="built_in">window</span>.jsInterface.getVersionName();</span><br><span class="line">      <span class="keyword">return</span> appversion;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>è°ƒç”¨æ–¹å¼<br><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*å¼‚æ­¥è°ƒç”¨*/</span></span><br><span class="line">NativeUtil.<span class="keyword">use</span>(</span><br><span class="line">  <span class="string">"choosePhoto"</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span><span class="params">(data)</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(data)</span><br><span class="line">  &#125;,</span><br><span class="line">  num</span><br><span class="line">);</span><br><span class="line"><span class="comment">/*åŒæ­¥è°ƒç”¨*/</span></span><br><span class="line">var appVersion=NativeUtil.<span class="keyword">use</span>(</span><br><span class="line">  <span class="string">"getAppVersion"</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å…¬å¸åŸæ¥çš„é¡¹ç›®æ˜¯ç”¨cordovaå‘½ä»¤è¡Œåˆ›å»ºçš„ï¼Œé¡µé¢UIå…¨æ˜¯webæŠ€æœ¯ç”»çš„ï¼Œç›®å‰é¡¹ç›®ä¼˜åŒ–å°†é¦–é¡µä»¥åŠåˆ—è¡¨é¡µé¢ç”¨åŸç”Ÿé‡å†™äº†ï¼Œä¹Ÿå¼ƒç”¨äº†ä¹‹å‰çš„cordovaæ¶æ„ï¼Œä½†æ˜¯ç”±äºä¹‹å‰é¡µé¢ä¹Ÿéœ€è¦åˆ°ä¸åŸç”Ÿäº¤äº’ï¼Œæˆ‘å°±è‡ªå·±ç®€å•å†™äº†ä¸ªæ–¹æ³•ç”¨æ¥ä¸åŸç”Ÿäº¤äº’&lt;br&gt;&lt;figure class=&quot;highli
      
    
    </summary>
    
    
      <category term="jsä¸åŸç”Ÿäº¤äº’" scheme="https://annilq.github.io/tags/js%E4%B8%8E%E5%8E%9F%E7%94%9F%E4%BA%A4%E4%BA%92/"/>
    
  </entry>
  
</feed>
